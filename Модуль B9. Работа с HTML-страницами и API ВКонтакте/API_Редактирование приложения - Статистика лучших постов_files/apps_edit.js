!function(e){function t(t){for(var a,o,r=t[0],n=t[1],c=t[2],p=0,l=[];p<r.length;p++)o=r[p],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&l.push(i[o][0]),i[o]=0;for(a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);for(d&&d(t);l.length;)l.shift()();return s.push.apply(s,c||[]),_()}function _(){for(var e,t=0;t<s.length;t++){for(var _=s[t],a=!0,r=1;r<_.length;r++){var n=_[r];0!==i[n]&&(a=!1)}a&&(s.splice(t--,1),e=o(o.s=_[0]))}return e}var a={},i={"web/apps_edit":0},s=[];function o(t){if(a[t])return a[t].exports;var _=a[t]={i:t,l:!1,exports:{}};return e[t].call(_.exports,_,_.exports,o),_.l=!0,_.exports}o.m=e,o.c=a,o.d=function(e,t,_){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:_})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var _=Object.create(null);if(o.r(_),Object.defineProperty(_,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(_,a,function(t){return e[t]}.bind(null,a));return _},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/js/cmodules/";var r=window.webpackJsonp=window.webpackJsonp||[],n=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var d=n;s.push([118,"vendors","common","145f605746e8e55e54cfd5bb0b7dca57"]),_()}({"0bzs":function(e,t,_){"use strict";_.r(t),_.d(t,"default",(function(){return s}));_("rGqo"),_("Btvt");var a=_("RJZa"),i=_("4+be");class s{constructor(e){this.uploadParams=e,this.uploads={},this.photos={}}init(e){Object.keys(e).forEach(e=>{this.initPhotoUpload(e)}),window.cur&&window.cur.destroy.push(()=>{Object.keys(this.uploads).forEach(e=>{window.Upload.deinit(this.uploads[e])})})}initPhotoUpload(e){if(this.needInitPhotoUpload(e)){var t=document.getElementById("apps_edit_activity_upload_photo"+e);t.classList.contains("disabled")||(this.uploads[e]=window.Upload.init(t,this.uploadParams.url,{},{file_name:"photo",lang:this.uploadParams.lang,file_size_limit:5242880,file_types_description:"Image files (*.jpg, *.jpeg, f*.png, *.gif)",file_types:"*.jpg;*.JPG;*.jpeg;*.JPEG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP",clear:1,type:"photo",noFlash:1,max_attempts:3,signed:1,static_url:this.uploadParams.static_url,check_url:this.uploadParams.check_url,base_url:this.uploadParams.base_url,buttonClass:"AppsEditActivityMediaPhoto__uploadButton",onUploadError:(e,t)=>{Object(a.showErrorBox)(Object(i.getLang)("apps_photo_notloaded_unknown"))},onNoFilteredCallback:()=>{Object(a.showErrorBox)(Object(i.getLang)("apps_edit_invalid_image_file"))},onUploadComplete:(t,_)=>{var o=JSON.parse(_)||{};if(!o.error&&o.photo&&(o.photo.sizes||o.photo.sizes2))this.photos[e]=o,s.markActivityChanged(e),s.toggleHasPhotoModifier(e,!0),s.setPhotoImageSrc(e,Object(a.photoObjToSrc)(o.photo,this.uploadParams.static_url,"b"));else{var r="ERR_UPLOAD_BAD_IMAGE_SIZE"===o.error?Object(i.getLang)("apps_edit_media_invalid_image_size"):Object(i.getLang)("apps_photo_notloaded_unknown");Object(a.showErrorBox)(r)}}}))}}removePhoto(e){this.photos[e]={action:"remove"},window.cur.activities&&window.cur.activities[e]&&(window.cur.activities[e].media.photoDeleted=!0),s.toggleHasPhotoModifier(e,!1),this.initPhotoUpload(e),s.markActivityChanged(e)}uploadPhoto(e){document.getElementById("apps_edit_activity_upload_photo"+e).getElementsByTagName("input")[0].click()}needInitPhotoUpload(e){return void 0===this.uploads[e]}revertChanges(e){if(this.photos[e]=null,window.cur.activities[e].media.photoDeleted=!1,window.cur.activities&&window.cur.activities[e]){var t=!!s.getPhotoSrc(e);s.getPhotoEl(e).classList.toggle(s.hasPhotoModifierCls,t),t&&(s.getPhotoImageEl(e).src=s.getPhotoSrc(e))}}getMediaForSave(e){var t={};return this.photos[e]&&(t.photo=this.photos[e]),t}onChangeActivity(e){void 0!==this.uploads[e]&&(window.Upload.deinit(this.uploads[e]),delete this.uploads[e])}static getPhotoSrc(e){var t=(window.cur.activities[e]||{}).media||{};return t.photoDeleted?"":t.photo}static getModifier(e){return s.getPhotoSrc(e)?s.hasPhotoModifierCls:""}static markActivityChanged(e){window.cur.activityChanged=window.cur.activityChanged||{},window.cur.activityChanged[e]=!0}static getPhotoImageEl(e){return document.getElementById(`${s.photoImgIdPrefix}${e}`)}static getPhotoEl(e){return document.getElementById(`${s.photoIdPrefix}${e}`)}static toggleHasPhotoModifier(e,t){var _=s.getPhotoEl(e);_&&_.classList.toggle(s.hasPhotoModifierCls,t)}static setPhotoImageSrc(e,t){var _=s.getPhotoImageEl(e);_&&(_.src=t)}}s.hasPhotoModifierCls="AppsEditActivityMediaPhoto--hasPhoto",s.photoImgIdPrefix="apps_edit_activity_media_image",s.photoIdPrefix="apps_edit_activity_media_photo"},118:function(e,t,_){e.exports=_("sjIN")},"4DY8":function(e,t,_){"use strict";_.r(t),_.d(t,"Sales",(function(){return w}));var a=_("q1tI"),i=_("i8i4"),s=(_("17x9"),_("ZxpX"));_("91GP");class o extends a.Component{constructor(e){super(e)}componentDidMount(){window.cur.soonUpdatePreview=()=>{}}render(){return a.createElement("div",{id:"dev_widget_colors"+this.props.id,className:"ColorPicker clear "+this.props.className},a.createElement("div",{id:"dev_colorpicker"+this.props.id,className:"dev_colorpicker_container ttb dev_tt_to_left",style:{display:"none"}},a.createElement("div",{className:"toup1"},a.createElement("div",{className:"ttb_cont"},a.createElement("div",{className:"tt_text"},a.createElement("div",{className:"dev_colorpicker"},a.createElement("div",{className:"dev_colorpicker_title"},this.props.title),a.createElement("div",{id:"dev_colors"+this.props.id,className:"dev_colors",onMouseDown:e=>window.Dev.colorsDown(e.nativeEvent,!0,void 0,void 0,void 0,this.props.id),style:{background:"#AAAAFF"}},a.createElement("img",{className:"dev_colors_grad",src:"/images/colorpicker_bg.png",width:176,height:176})),a.createElement("canvas",{id:"dev_palette"+this.props.id,className:"dev_palette",onMouseDown:e=>window.Dev.paletteDown(e.nativeEvent,!0,void 0,void 0,this.props.id),width:20,height:176}),a.createElement("div",{id:"dev_picker1"+this.props.id,className:"dev_picker1"}),a.createElement("div",{id:"dev_picker2"+this.props.id,className:"dev_picker2"})))),a.createElement("div",{className:"bottom_pointer"}))),this.props.children)}}class r extends a.Component{constructor(e){super(e),this.onChangeHandler=()=>{this.props.onChange&&this.props.onChange({target:{value:this.element.value}})},this.showColorBox=(e,t)=>{window.Dev.showColorBox(e.target,t,e.nativeEvent,this.props.pickerId)},this.getRef=e=>{this.element=e},this.onChange=e=>{this.props.onChange&&this.props.onChange(e)}}componentDidMount(){window.addEvent(this.element,"valueChanged",this.onChangeHandler)}componentWillUnmount(){window.removeEvent(this.element,"valueChanged",this.onChangeHandler)}getBackgroundColor(e){return"#"===e.slice(0,1)?e:"#"+e}render(){var e=this.props,t=e.id,_=e.className;return a.createElement("div",{className:"ColorPickerInput"},a.createElement("input",{id:"widget_color"+t,value:this.props.value,onChange:this.onChange,className:_,disabled:this.props.disabled,readOnly:this.props.readOnly,ref:this.getRef}),a.createElement("span",{onMouseOver:e=>{this.showColorBox(e,t)},className:"ColorPickerInput__selector dev_colorbox_cont"},a.createElement("span",{className:"ColorPickerInput__current dev_colorbox",id:"dev_colorbox"+t,style:{backgroundColor:this.getBackgroundColor(this.props.value)}}," ")))}}var n=_("6krn"),c=_("6raB"),d=_("BAjI"),p=_("Ht+d"),l=_("XTb9"),u=_("RJZa"),h=_("t7n3"),b=_("FWc3"),E=_("z1JT");function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var _=arguments[t];for(var a in _)Object.prototype.hasOwnProperty.call(_,a)&&(e[a]=_[a])}return e}).apply(this,arguments)}class g extends a.Component{constructor(e){super(e),this.toggle=()=>{this.setState({expanded:!this.state.expanded})},this.save=()=>{var e=this.state.product.isNew,t=e?"a_add_sale_product":"a_save_sale_product";this.setState({loadingPrimaryButton:!0}),Object(u.ajax)("editapp",{act:t,product_id:this.state.product.id,app_id:this.state.product.app_id,action_id:this.state.product.action_id,hash:this.state.product.hash,name:this.state.product.name,price:this.state.product.price,sale_price:this.state.product.sale_price,color_from:this.state.product.color_from,color_to:this.state.product.color_to,photo_data:this.state.product.photo_data}).then(t=>{t.isNew=!1,t.photo_data=null,t.name=Object(h.unclean)(t.name);var _=Object(u.deepClone)(t);e&&(this.props.onChangeList(t),t.newId=this.state.product.id),this.setState({product:t,productCopy:_,loadingPrimaryButton:!1,showSuccess:!0,error:""})},e=>{this.setState({loadingPrimaryButton:!1}),this.showError(e)})},this.disable=()=>{Object(u.confirm)(Object(n.getLang)("global_action_confirmation"),Object(n.getLang)("apps_edit_sales_stop_confirm")).then(()=>{Object(u.lockBoxButton)();Object(u.ajax)("editapp",{act:"a_disable_sale_product",product_id:this.state.product.id,app_id:this.state.product.app_id,action_id:this.state.product.action_id,hash:this.state.product.hash}).then(()=>{var e=m({},this.state.product);e.state=E.STATE_DISABLED,this.setState({product:e}),Object(u.hideBox)(),this.props.onChangeList(e)},e=>{Object(u.showErrorBox)(e)})},u.hideBox)},this.deleteProduct=()=>{Object(u.confirm)(Object(n.getLang)("global_action_confirmation"),Object(n.getLang)("apps_edit_sales_delete_confirm")).then(()=>{Object(u.lockBoxButton)();Object(u.ajax)("editapp",{act:"a_delete_sale_product",product_id:this.state.product.id,app_id:this.state.product.app_id,action_id:this.state.product.action_id,hash:this.state.product.hash}).then(()=>{var e=m({},this.state.product);e.state=E.STATE_DELETED,this.setState({product:e}),Object(u.hideBox)(),this.props.onChangeList(e)},e=>{Object(u.showErrorBox)(e)})},u.hideBox)},this.successShown=()=>{this.setState({showSuccess:!1})},this.cancel=()=>{var e=!1,t=this.state.product.isNew;for(var _ in this.state.product)if(this.state.product.hasOwnProperty(_)&&this.state.product[_]!==this.state.productCopy[_]){e=!0;break}e?Object(u.confirm)(Object(n.getLang)("global_action_confirmation"),Object(n.getLang)("apps_edit_sales_cancel_confirm")).then(()=>{t?this.removeNewProduct():this.cancelProductChanges(),Object(u.hideBox)()},u.hideBox):t?this.removeNewProduct():this.toggle()},this.cancelProductChanges=()=>{var e=Object(u.deepClone)(this.state.product);e=window.extend(e,this.state.productCopy,!0),this.setState({product:e}),this.toggle()},this.removeNewProduct=()=>{var e=m({},this.state.product);e.state=E.STATE_DELETED,this.setState({product:e}),this.props.onChangeList(e)},this.showStateHint=e=>{var t=e.target,_={[E.STATE_PENDING]:Object(n.getLang)("apps_edit_sales_product_hint_pending"),[E.STATE_APPROVED]:Object(n.getLang)("apps_edit_sales_product_hint_approved"),[E.STATE_DECLINED]:Object(n.getLang)("apps_edit_sales_product_hint_declined"),[E.STATE_DISABLED]:Object(n.getLang)("apps_edit_sales_product_hint_disabled")};return t.tt&&window.tooltips&&window.tooltips.destroy(t),Object(b.showHint)(t,{text:_[this.state.product.state]})},this.props.product.name=Object(h.unclean)(this.props.product.name),this.state={product:e.product,productCopy:m({},e.product),expanded:e.expanded||e.product.expanded,loadingPrimaryButton:!1,showSuccess:!1,error:""},this.baseCls="appsEdit_SalesProduct"}cls(e){for(var t=arguments.length,_=new Array(t>1?t-1:0),a=1;a<t;a++)_[a-1]=arguments[a];return Object(u.cls)(this.baseCls,e,..._)}stateToModifier(){return{0:"new",[E.STATE_APPROVED]:"approved",[E.STATE_DISABLED]:"disabled",[E.STATE_PENDING]:"pending",[E.STATE_DECLINED]:"declined"}[this.state.product.state]}onChange(e,t){var _=m({},this.state.product);_[e]=t.target.value,this.setState({product:_})}showError(e){this.setState({error:e})}photoObjToSrc(e){var t=this.props.uploadParams.static_url,_=window.isRetina()?e.sizes[2]:e.sizes[1];return t=t+"v"+[_[1],_[2],_[3]].join("/")+".jpg"}componentDidMount(){var e=document.getElementById("sales_products_upload_link"+this.state.product.id);this.upload=window.Upload.init(e,this.props.uploadParams.url,{},{file_name:"photo",lang:this.props.uploadParams.lang,file_size_limit:5242880,file_types_description:"Image files (*.jpg, *.jpeg, *.png, *.gif)",file_types:"*.jpg;*.JPG;*.jpeg;*.JPEG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP",clear:1,type:"photo",noFlash:1,max_attempts:3,signed:1,static_url:this.props.uploadParams.static_url,check_url:this.props.uploadParams.check_url,base_url:this.props.uploadParams.base_url,buttonClass:this.cls("__uploadButton"),onUploadError:(e,t)=>{Object(u.showErrorBox)(Object(n.getLang)("apps_photo_notloaded_unknown"))},onNoFilteredCallback:()=>{Object(u.showErrorBox)(Object(n.getLang)("apps_edit_invalid_image_file"))},onUploadComplete:(e,t)=>{var _=JSON.parse(t)||{};if(!_.error&&_.photo&&_.photo.sizes){var a=this.photoObjToSrc(_.photo),i=m({},this.state.product);i.photo_data=t,i.icon_src=a,this.setState({product:i})}else{var s="ERR_UPLOAD_BAD_IMAGE_SIZE"===_.error?Object(n.getLang)("apps_edit_sales_product_invalid_image_size"):Object(n.getLang)("apps_photo_notloaded_unknown");Object(u.showErrorBox)(s)}}})}componentWillUnmount(){this.upload&&window.Upload.deinit(this.upload)}renderHeader(){return a.createElement("div",{className:this.cls("__header"),role:"button",onClick:this.toggle},a.createElement("h3",{className:this.cls("__name")},this.state.product.name||(this.state.product.state!==E.STATE_NEW?Object(n.getLang)("apps_edit_sales_product_name_placeholder"):Object(n.getLang)("apps_edit_sales_new_product"))),a.createElement("span",{className:this.cls("__state"),onMouseOver:this.showStateHint}))}renderForm(){return a.createElement("div",{className:this.cls("__form")},this.state.error?a.createElement("div",{className:this.cls("__error")},a.createElement("span",{className:this.cls("__errorTitle")},Object(n.getLang)("apps_edit_sales_error_title")),this.state.error):"",a.createElement("div",{className:this.cls("__formContent")},a.createElement("div",{className:this.cls("__controls")},a.createElement("div",{className:this.cls("__row")},a.createElement("label",{className:this.cls("__label")},Object(n.getLang)("apps_edit_sales_product_name")),a.createElement("input",{placeholder:Object(n.getLang)("apps_edit_sales_product_name_placeholder"),name:"name",value:this.state.product.name,className:"dark name",onChange:this.onChange.bind(this,"name"),autoComplete:"off"})),a.createElement("div",{className:this.cls("__row")},a.createElement("label",{className:this.cls("__label")},Object(n.getLang)("apps_edit_sales_product_price")),a.createElement("div",{className:this.cls("__currencyInput")},a.createElement("input",{value:this.state.product.price,className:"dark",onChange:this.onChange.bind(this,"price")}),a.createElement("span",{className:this.cls("__currency")},Object(n.getLang)("apps_edit_sales_product_currency_votes",+this.state.product.price)))),a.createElement("div",{className:this.cls("__row")},a.createElement("label",{className:this.cls("__label")},Object(n.getLang)("apps_edit_sales_product_sale_price")),a.createElement("div",{className:this.cls("__currencyInput")},a.createElement("input",{value:this.state.product.sale_price,className:"dark",onChange:this.onChange.bind(this,"sale_price")}),a.createElement("span",{className:this.cls("__currency")},Object(n.getLang)("apps_edit_sales_product_currency_votes",+this.state.product.sale_price)))),a.createElement("div",{className:this.cls("__row")},a.createElement("label",{className:this.cls("__label")},Object(n.getLang)("apps_edit_sales_product_icon")),a.createElement("a",{className:this.cls("__uploadLink"),id:"sales_products_upload_link"+this.state.product.id},Object(n.getLang)("apps_edit_sales_product_icon_upload"))),a.createElement(o,{className:"appsEdit_SalesColorPicker",title:Object(n.getLang)("apps_edit_sales_product_select_color"),id:this.state.product.id},a.createElement("div",{className:this.cls("__row")},a.createElement("label",{className:this.cls("__label")},Object(n.getLang)("apps_edit_sales_product_color_from")),a.createElement(r,{value:this.state.product.color_from||E.DEFAULT_PRODUCT_COLOR,id:"color_from"+this.state.product.id,pickerId:this.state.product.id,className:"dark",onChange:this.onChange.bind(this,"color_from")})),a.createElement("div",{className:this.cls("__row")},a.createElement("label",{className:this.cls("__label")},Object(n.getLang)("apps_edit_sales_product_color_to")),a.createElement(r,{value:this.state.product.color_to||E.DEFAULT_PRODUCT_COLOR,id:"color_to"+this.state.product.id,pickerId:this.state.product.id,className:"dark",onChange:this.onChange.bind(this,"color_to")}))),a.createElement("div",{className:this.cls("__row")},a.createElement("label",{className:this.cls("__label")},Object(n.getLang)("apps_edit_sales_product_ref")),a.createElement("span",{className:this.cls("__ref")},this.state.product.ref))),a.createElement("div",{className:this.cls("__product")},a.createElement(d.default,{app:this.props.app,product:this.state.product,key:this.state.product.id}))))}renderFooter(){return a.createElement("div",{className:this.cls("__footer")},a.createElement("div",{className:this.cls("__feltButtons")},a.createElement(c.default,{className:this.cls("__save"),loading:this.state.loadingPrimaryButton,onClick:this.save},Object(n.getLang)("apps_edit_sales_product_save")),a.createElement(p.default,{appearance:"link",className:this.cls("__cancel",{hidden:this.state.showSuccess}),onClick:this.cancel},Object(n.getLang)("apps_edit_sales_cancel")),a.createElement(l.default,{shown:this.state.showSuccess,callback:this.successShown,className:{hidden:!this.state.showSuccess}},Object(n.getLang)("apps_changes_saved"))),a.createElement("div",{className:this.cls("__rightButtons")},inArray(this.state.product.state,[E.STATE_APPROVED,E.STATE_PENDING])?a.createElement(p.default,{appearance:"link",className:this.cls("__rightButton","__stop"),onClick:this.disable},Object(n.getLang)("apps_edit_sales_stop_product")):"",this.state.product.state!==E.STATE_NEW?a.createElement(p.default,{appearance:"link",className:this.cls("__rightButton","__delete"),onClick:this.deleteProduct},Object(n.getLang)("apps_edit_sales_delete_product")):""))}render(){return a.createElement("div",{className:this.cls("",this.stateToModifier(),{expanded:this.state.expanded})},this.renderHeader(),a.createElement("div",{className:this.cls("__content")},this.renderForm(),this.renderFooter()))}}class v extends a.Component{constructor(e){super(e),this.toggleProducts=()=>{this.setState({expanded:!this.state.expanded})},this.getProductCount=e=>e.reduce((e,t)=>t.state!==E.STATE_DELETED?e+1:e,0),this.getRunningCount=e=>e.reduce((e,t)=>t.state===E.STATE_APPROVED?e+1:e,0),this.addNewProduct=()=>{var e={app_id:this.props.appId,action_id:this.props.action.id,id:`new-${this.props.action.id}-${this.state.newNumber}`,hash:this.props.addHash,isNew:!0,expanded:!0,name:"",price:0,sale_price:0,color_from:E.DEFAULT_PRODUCT_COLOR,color_to:E.DEFAULT_PRODUCT_COLOR,state:E.STATE_NEW},t=this.state.products.slice();t.push(e),this.setState({products:t,newNumber:this.state.newNumber+1,productsCount:this.getProductCount(t)})},this.onChangeList=e=>{for(var t=this.state.products.slice(),_=0;_<t.length;_++){var a=t[_];if((a.id===e.id||a.id===e.newId)&&a.action_id===e.action_id){t[_]=e;break}}this.setState({products:t,runningCount:this.getRunningCount(t),productsCount:this.getProductCount(t)})};var t=e.products.reduce((e,t)=>t.state===E.STATE_APPROVED?e+1:e,0),_=e.products.length;this.state={products:e.products,expanded:e.expanded,newNumber:1,runningCount:t,productsCount:_},this.baseCls="appsEdit_SalesAction",this.maxProductsCount=4}cls(e){for(var t=arguments.length,_=new Array(t>1?t-1:0),a=1;a<t;a++)_[a-1]=arguments[a];return Object(s.classNames)(this.baseCls+e,..._)}render(){return a.createElement("div",{className:this.cls("",{new:this.props.action.is_new})},a.createElement("div",{className:this.cls("__header"),role:"button",onClick:this.toggleProducts},a.createElement("div",{className:this.cls("__title")},a.createElement("h2",{className:this.cls("__name")},this.props.action.name),a.createElement("div",{className:this.cls("__counters")},this.state.runningCount?a.createElement("span",{className:this.cls("__counter")},this.state.runningCount," ",Object(n.getLang)("apps_edit_sales_product_running_count",this.state.runningCount)):"",this.state.productsCount?a.createElement("span",{className:this.cls("__counter")},this.state.productsCount," ",Object(n.getLang)("apps_edit_sales_product_count",this.state.productsCount)):"")),a.createElement("span",{className:this.cls("__desc")},this.props.action.description)),a.createElement("div",{className:this.cls("__products",{expanded:this.state.expanded})},this.state.products.map(e=>{if(e.state!==E.STATE_DELETED)return a.createElement(g,{app:this.props.app,uploadParams:this.props.uploadParams,product:e,key:"product_"+e.id+"_"+e.action_id,onChangeList:this.onChangeList})}),this.state.productsCount<this.maxProductsCount?a.createElement("button",{className:this.cls("__addNewButton"),onClick:this.addNewProduct},Object(n.getLang)("apps_edit_sales_add_product")):""))}}var O=_("FEsp");class f extends a.Component{constructor(e){super(e)}render(){return a.createElement("div",{className:"appsEdit_ActionsList"},this.props.actions.length?this.props.actions.map(e=>a.createElement(v,{appId:this.props.appId,key:"action"+e.id,addHash:this.props.addHash,action:e,products:this.props.products[e.id],app:this.props.app,expanded:1===this.props.actions.length,uploadParams:this.props.uploadParams})):a.createElement(O.default,null,"No results."))}}var w={init:function(e,t,_,s,o,r,n){addLangKeys(r),i.render(a.createElement(f,{appId:e,actions:t,addHash:o,products:_,app:s,uploadParams:n}),document.querySelector("#app_sales_actions"))}}},"6krn":function(e,t,_){"use strict";_.r(t),_.d(t,"getLang",(function(){return o}));var a=_("nAFc"),i=_("4+be"),s={};function o(e,t,_){void 0===t&&(t=!1);var o="number"==typeof t,r=t||o,n=e+(r?".raw":"");if(void 0===s[n]){var c=r?Object(i.getLang)(e,"raw"):Object(i.getLang)(e);"string"==typeof c?s[n]=Object(a.decodeHTMLEntities)(c):Array.isArray(c)&&(s[n]=c.map(a.decodeHTMLEntities))}if(o){var d=t;return Object(i.langNumeric)(d,s[n],_)}return s[n]||""}t.default={getLang:o}},BAjI:function(e,t,_){"use strict";_.r(t),_.d(t,"default",(function(){return n}));_("pIFo");var a=_("q1tI"),i=(_("17x9"),_("ZxpX")),s=_("6krn"),o=_("z1JT"),r=_("RJZa");class n extends a.Component{constructor(e){super(e),this.baseCls="AppsSalesProduct"}cls(e){for(var t=arguments.length,_=new Array(t>1?t-1:0),a=1;a<t;a++)_[a-1]=arguments[a];return e=e||"",_=_.map(e=>"__"===e.slice(0,2)?this.baseCls+e:e),Object(i.classNames)(this.baseCls+e,..._)}getDefaultIconSrc(){return isRetina()?o.DEFAULT_PRODUCT_ICON_SRC.replace(".png","_2x.png"):o.DEFAULT_PRODUCT_ICON_SRC}getSaleHref(){var e=window.nav.fromStr(this.props.app.href);return e.sales_ref=this.props.product.ref,window.nav.toStr(e)}getBackgroundColor(e){return"#"===(e=e||o.DEFAULT_PRODUCT_COLOR).slice(0,1)?e:"#"+e}render(){return a.createElement("div",{className:this.cls(),style:{backgroundImage:`linear-gradient(to bottom, ${this.getBackgroundColor(this.props.product.color_from)}, ${this.getBackgroundColor(this.props.product.color_to)}`}},a.createElement("a",{className:this.cls("__link"),href:this.getSaleHref(),target:"_blank"},a.createElement("div",{className:this.cls("__app")},a.createElement("img",{src:this.props.app.icon_src,className:this.cls("__appIcon")}),a.createElement("span",{className:this.cls("__appName")},this.props.app.name),a.createElement("div",{className:"apps_rate_cat clear_fix"},Object(r.getValues)(this.props.app.rate).map((e,t)=>a.createElement("span",{className:"app_rate fl_l "+e,key:"rate_"+t+"_"+this.props.product.id}))),a.createElement("span",{className:this.cls("__appGenre")},this.props.app.genre)),a.createElement("div",{className:this.cls("__product")},a.createElement("img",{src:this.props.product.icon_src||this.getDefaultIconSrc(),className:this.cls("__icon")}),a.createElement("div",{className:this.cls("__info")},a.createElement("span",{className:this.cls("__name")},unclean(this.props.product.name)||Object(s.getLang)("apps_edit_sales_new_product_name")),a.createElement("div",{className:this.cls("__prices")},a.createElement("span",{className:this.cls("__price","__salePrice")},+this.props.product.sale_price?this.props.product.sale_price+" "+Object(s.getLang)("apps_sales_votes",+this.props.product.sale_price):Object(s.getLang)("apps_edit_sales_new_product_sale_price")),a.createElement("span",{className:this.cls("__price","__actualPrice")},+this.props.product.price?this.props.product.price+" "+Object(s.getLang)("apps_sales_votes",+this.props.product.price):Object(s.getLang)("apps_edit_sales_new_product_price")))))),this.props.aside?a.createElement("div",{className:this.cls("__aside")},this.props.aside):"")}}},BVwM:function(e,t,_){"use strict";_.r(t),_.d(t,"ModerationRequest",(function(){return c}));var a=_("EasH"),i=_("aong"),s=_("zxIV"),o=_("4+be"),r=_("v+DW"),n=_("2W9W");class c{constructor(){this.commentsOffset=0,this.commentsPerPage=20,this.commentsRequestInProgress=!1,this.hasMoreComments=!1}initOnScrollListener(e){if(this.commentsOffset=0,this.commentsPerPage=20,Object(n.isIntersectionObserverSupported)()){var t=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&this.requestNextComments(e)})}),_=document.getElementById("more_comments");_&&(t.observe(_),window.cur.destroy.push(()=>{t.unobserve(_)}))}}initLanguages(e){Object(o.addLangKeys)(e)}setHasMoreComments(e){this.hasMoreComments=e}sendDirectGamesRequest(e){Object(a.showBox)("editapp",{act:"send_dg_check_box",id:e},{onDone:(t,_)=>{if(!_.error){var a=_.hash;t.removeButtons(),t.addButton(Object(o.getLang)("apps_send_check"),()=>{this.doSendCheckDg(t,e,a)},void 0,void 0,"submit_dg_request"),t.addButton(Object(o.getLang)("global_close"),t.hide,"no"),this.refreshSubmitButton()}}})}doSendCheckDg(e,t,_){var a=Object(r.isChecked)(document.getElementById("app_dg_check_android")),o=Object(r.isChecked)(document.getElementById("app_dg_check_ios")),n=Object(r.isChecked)(document.getElementById("app_dg_check_mvk")),c=document.getElementById("box_comment"),d=c?c.value:"";e.showProgress(),ajax.post("editapp",{act:"check_request_dg",id:t,hash:_,comment:d,android:a,ios:o,mvk:n},{onDone:function(t,_,a){e.hide();var o=document.getElementById("app_edit_dg_cont");if(o&&(o.innerHTML=t),_){var r=document.getElementById("comments");r&&(r.innerHTML=_),Object(s.show)("app_edit_history_block")}Object(i.updateMoney)(a)},onFail:function(t){e.hideProgress();var _=document.getElementById("app_check_box_error");return _&&(_.innerHTML=t,Object(s.show)("app_check_box_error")),!0}})}sendWebRequest(e){Object(a.showBox)("editapp",{act:"send_check_box",id:e},{onDone:(t,_)=>{if(!_.error){var a=_.hash;t.removeButtons(),t.addButton(Object(o.getLang)("apps_send_check"),()=>{this.doSendCheckWeb(t,e,a)}),t.addButton(Object(o.getLang)("global_close"),t.hide,"no")}}})}doSendCheckWeb(e,t,_){var a=document.getElementById("box_comment"),o=a?a.value:"";e.showProgress(),ajax.post("editapp",{act:"check_request",id:t,hash:_,comment:o},{onDone:function(t,_,a){e.hide();var o=document.getElementById("app_cur_status");if(o&&(o.innerHTML=t),_){var r=document.getElementById("comments");r&&(r.innerHTML=_),Object(s.show)("app_edit_history_block")}Object(i.updateMoney)(a)},onFail:function(t){e.hideProgress();var _=document.getElementById("app_check_box_error");return _&&(_.innerHTML=t,Object(s.show)("app_check_box_error")),!0}})}refreshSubmitButton(){var e=document.getElementById("submit_dg_request");if(e){var t=document.getElementById("app_dg_check_android"),_=document.getElementById("app_dg_check_ios"),a=document.getElementById("app_dg_check_mvk"),i=Object(r.isChecked)(t)&&!t.classList.contains("disabled"),s=Object(r.isChecked)(_)&&!_.classList.contains("disabled"),o=Object(r.isChecked)(a)&&!a.classList.contains("disabled"),n=i||s||o;e.classList.toggle("button_disabled",!n)}}toggleSms(e,t,_){if(Object(r.checkbox)(e),!document.getElementById("sms"))return!1;ajax.post("editapp",{act:"toggle_sms",id:t,hash:_,sms:Object(r.isChecked)("sms")})}requestNextComments(e){var t=document.getElementById("more_comments"),_=document.getElementById("more_comments_prg");if(!this.commentsRequestInProgress&&this.hasMoreComments){this.commentsRequestInProgress=!0;var a=this.commentsOffset+this.commentsPerPage;return ajax.post("editapp",{act:"get_checks_comments",id:e,offset:a},{cache:1,onDone:(e,t)=>{(this.commentsRequestInProgress=!1,this.commentsOffset+=this.commentsPerPage,e)&&document.getElementById("comments").insertAdjacentHTML("beforeend",e);this.hasMoreComments=t,t||Object(s.hide)("more_comments")},onFail:()=>{this.commentsRequestInProgress=!1},showProgress:function(){Object(s.show)(_),Object(s.hide)(t.firstChild)},hideProgress:function(){Object(s.show)(t.firstChild),Object(s.hide)(_)}}),!1}}}},FEsp:function(e,t,_){"use strict";_.r(t);var a=_("q1tI"),i=_.n(a),s=_("ZxpX"),o=function(){return(o=Object.assign||function(e){for(var t,_=1,a=arguments.length;_<a;_++)for(var i in t=arguments[_])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},r=function(e,t){var _={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(_[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(_[a[i]]=e[a[i]])}return _};t.default=function(e){var t=e.children,_=e.className,a=r(e,["children","className"]);return i.a.createElement("div",o({},a,{className:Object(s.classNames)("Stub",_)}),t||"No results.")}},"Gb+U":function(e,t,_){"use strict";_.r(t),_.d(t,"default",(function(){return i}));var a=_("kcIO");class i{constructor(e,t){this.options=e,this.currentBox=t}getOptions(){return{file_name:"file",file_size_limit:this.options.file_size_limit,file_types_description:"All files, *.*",file_types:"*.exe;*.dmg;*.pkg;*.zip;*.deb;*.rpm",lang:this.options.lang,onUploadStart:this.onUploadStart.bind(this),onUploadProgress:this.onUploadProgress.bind(this),onUploadError:this.onUploadError.bind(this),onUploadComplete:this.onUploadComplete.bind(this),clear:1,max_attempts:3,server:this.options.server,error:this.options.default_error,error_hash:this.options.error_hash,noCheck:this.options.no_check,type:this.options.type_doc,dropbox:"AppsDistributiveDropbox"}}onUploadStart(e){hide("AppsEditUploadDistributiveError")}onUploadProgress(e,t,_){if(window.Upload){var a=window.Upload.obj[e],i=document.querySelector(".ProgressUploadDistributive");if(i){if(!i.classList.contains("ProgressUploadDistributive__processing")){for(var s=a.firstChild;s;)1===s.nodeType&&a.classList.add("unshown"),s=s.nextSibling;i.classList.add("ProgressUploadDistributive__processing")}var o=intval(t/_*100),r=i.querySelector(".apps_upload_progress");r&&setStyle(r,{width:o+"%"})}}}onUploadError(e,t){show("AppsEditUploadDistributiveError"),i.resetProgress(e)}onUploadComplete(e,t){var _;try{_=JSON.parse(t)}catch(e){_=AjaxConvert.fromQueryString(t)}_.code&&window.Upload?window.Upload.onUploadError(e,_.code):ajax.post("editapp",extend(_,{act:"a_save_distributive",app_id:this.options.app_id,platform_id:this.options.platform_id}),{onDone:e=>{this.currentBox&&this.currentBox.hide();var t=document.querySelector(".DownloadedGameDistributive__file--"+this.options.platform_id);e.html&&t&&(t.innerHTML=e.html),e.notify&&Object(a.showDoneBox)(e.notify,{out:6e3})},onFail:t=>{var _=document.querySelector("#AppsEditUploadDistributiveError");_&&(_.innerHTML=t),window.Upload&&window.Upload.onUploadError(e,t)}})}static resetProgress(e){var t=document.querySelector(".ProgressUploadDistributive");if(t){t.classList.remove("ProgressUploadDistributive__processing");var _=t.querySelector(".apps_upload_progress");if(_&&setStyle(_,{width:0}),window.Upload){var a=window.Upload.obj[e];a&&a.classList.remove("unshown")}}}}},RJZa:function(e,t,_){"use strict";_.r(t),_.d(t,"confirm",(function(){return r})),_.d(t,"cls",(function(){return n})),_.d(t,"lockBoxButton",(function(){return c})),_.d(t,"hideBox",(function(){return d})),_.d(t,"showErrorBox",(function(){return p})),_.d(t,"ajax",(function(){return l})),_.d(t,"getValues",(function(){return u})),_.d(t,"deepClone",(function(){return h})),_.d(t,"photoObjToSrc",(function(){return b}));_("VRzm"),_("Btvt");var a=_("EasH"),i=_("ZxpX"),s=_("6krn"),o=_("t7n3");function r(e,t){return new Promise((_,i)=>{var o={title:e,onHide:i};return new a.MessageBox(o).content(t).setButtons(Object(s.getLang)("global_yes"),_,Object(s.getLang)("global_cancel"),i).show()})}function n(e,t){for(var _=arguments.length,a=new Array(_>2?_-2:0),s=2;s<_;s++)a[s-2]=arguments[s];return t=t||"",a=a.map(t=>isString(t)&&"_"===t.slice(0,1)?e+t:t),Object(i.classNames)(e+t,...a)}function c(){var e=curBox();if(e){var t=e.btns.ok[0];t&&window.lockButton(t)}}function d(){var e=curBox();e&&e.hide()}function p(e){d(),Object(a.showFastBox)(Object(s.getLang)("global_error"),e)}function l(e,t){return new Promise((_,a)=>{window.ajax.post(e,t,{onDone:function(){_(...arguments)},onFail:function(){return a(...arguments),!0}})})}function u(e){var t=[];for(var _ in e)e.hasOwnProperty(_)&&t.push(e[_]);return t}function h(e){return Object(o.clone)(e,!0)}function b(e,t){var _=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"a",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"b";_=window.isRetina()?a:_;var i="";if(!e.sizes2&&!e.sizes)return i;var s=e.sizes2?e.sizes2:e.sizes,o=e.urls2?e.urls2:e.urls;if(!s||!s.length)return i;for(var r=0;r<s.length;r++){var n=s[r];if(n[0]===_)return t+o[r]}return i}},WupO:function(e,t,_){"use strict";_.r(t),_.d(t,"GraphsHelper",(function(){return a}));_("rGqo"),_("Btvt");class a{initGraphHorizontalMenu(e){var t=document.getElementById(e),_={graphId:e,clickNode:t,graph:this.pageGraphs[e]};addEvent(t,"click",this.onClickGraphHorizontalMenu,null,_)}onClickGraphHorizontalMenu(e){var t=document.querySelectorAll(".DownloadedGameStatGraph");t&&t.forEach(e=>{e.classList.remove("active")}),e.data.graph.loadGraph(e.data.graphId),e.data.clickNode&&e.data.clickNode.classList.add("active"),cancelEvent(e)}initGraph(e){var t=document.getElementById("wrapper_"+e).offsetWidth;this.pageGraphs[e]=new window.Graph(e,this.graphDatas[e],this.graphParams[e],t,intval(2*t/3)),this.initGraphHorizontalMenu(e)}init(e){var t={isRTL:window.is_rtl};extend(t,e.graphVars),this.graphDatas=e.graphsData,this.graphParams=e.graphParams,this.pageGraphs={},cur.graphVars=t,cur.html5graphs=!0;for(var _=Object.keys(e.graphsData),a=0,i=_;a<i.length;a++){var s=i[a];this.initGraph(s)}var o=document.getElementById(_[0]);o&&o.classList.add("active")}}},XTb9:function(e,t,_){"use strict";_.r(t),_.d(t,"default",(function(){return r}));_("91GP"),_("ioFf"),_("rGqo"),_("Btvt");var a=_("q1tI"),i=(_("17x9"),_("ZxpX"));function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var _=arguments[t];for(var a in _)Object.prototype.hasOwnProperty.call(_,a)&&(e[a]=_[a])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var _,a,i=function(e,t){if(null==e)return{};var _,a,i={},s=Object.keys(e);for(a=0;a<s.length;a++)_=s[a],t.indexOf(_)>=0||(i[_]=e[_]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)_=s[a],t.indexOf(_)>=0||Object.prototype.propertyIsEnumerable.call(e,_)&&(i[_]=e[_])}return i}class r extends a.Component{constructor(e){super(e),this.onTransitionEnd=e=>{this.state.shown&&"opacity"===e.propertyName&&(this.timeout=setTimeout(()=>{this.setState({shown:!1}),this.props.callback()},this.props.duration))},this.state={shown:e.shown}}componentWillReceiveProps(e){!this.props.shown&&e.shown&&this.setState({shown:!0})}componentWillUnmount(){this.timeout&&clearTimeout(this.timeout)}render(){var e=this.props,t=(e.shown,e.callback,e.duration,e.className),_=e.children,r=o(e,["shown","callback","duration","className","children"]),n=Object(i.classNames)("BlinkText",{"BlinkText--shown":this.state.shown},t);return a.createElement("span",s({},r,{className:n,onTransitionEnd:this.onTransitionEnd,"aria-hidden":!0}),_)}}r.defaultProps={duration:2e3}},pujQ:function(e,t,_){"use strict";_.r(t),_.d(t,"MarusiaSkill",(function(){return r}));_("91GP"),_("OG14"),_("HEwt");var a=_("v+DW"),i=_("zxIV"),s=_("4+be");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var _=arguments[t];for(var a in _)Object.prototype.hasOwnProperty.call(_,a)&&(e[a]=_[a])}return e}).apply(this,arguments)}class r{static getBody(){return document.getElementsByClassName(r.bodyClassName)[0]}static getDevBody(){return document.getElementsByClassName(r.bodyDevClassName)[0]}static getAddBtnContainer(){return document.getElementsByClassName(r.addBtnContainerClassName)[0]}getTemplate(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return`\n    <td class='apps_edit_label ta_r'></td>\n    <td style='position: relative;'>\n      <input class='dark text apps_edit_input' id='${t?r.idDevTemplate:r.idTemplate}${e}' maxlength='${r.MAX_PHRASE_LENGTH}'>\n      <div class='pedit_right_control'>\n        ${0===e?"":`<button class='AppsEditDeleteBtn' data-title='Удалить' onclick='AppsEdit.MarusiaSkill.${t?"removeMarusiaDevPhrase":"removeMarusiaPhrase"}(${e}, this)' onmouseover='window.showTitle(this);'></button>`}\n      </div>\n      <span id='app_name_${e}_notice' style='display: none;'></span>\n    </td>`}getElement(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],_=document.createElement("tr");return _.classList.add(r.rowClassName),_.innerHTML=this.getTemplate(e,t),_}countItems(){return r.getBody().childElementCount}countDevItems(){return r.getDevBody().childElementCount}incrementCounter(){this.counter=this.countItems()+1}decrementCounter(){this.counter=this.countItems()-1}incrementDevCounter(){this.devCounter=this.countDevItems()+1}decrementDevCounter(){this.devCounter=this.countDevItems()-1}toggleAddBtn(e,t){e>=r.MAX_PHRASE_COUNT?t.classList.add(r.addBtnContainerClassName+"--hide"):t.classList.remove(r.addBtnContainerClassName+"--hide")}addMarusiaPhrase(e){this.incrementCounter(),this.toggleAddBtn(this.counter,e),r.getBody().appendChild(this.getElement(this.counter))}addMarusiaDevPhrase(e){this.incrementDevCounter(),this.toggleAddBtn(this.devCounter,e),r.getDevBody().appendChild(this.getElement(this.devCounter,!0))}removeMarusiaPhrase(e){this.decrementCounter(),this.toggleAddBtn(this.counter,document.getElementById(r.idAddBtn));var t=document.getElementById(`${r.idTemplate}${e}`);if(t){var _=t.closest("."+r.rowClassName);_&&_.remove()}}removeMarusiaDevPhrase(e){this.decrementDevCounter(),this.toggleAddBtn(this.devCounter,document.getElementById(r.idAddBtnDev));var t=document.getElementById(`${r.idDevTemplate}${e}`);if(t){var _=t.closest("."+r.rowClassName);_&&_.remove()}}static getPhrases(){return Array.from(document.querySelectorAll("[id^='"+r.idTemplate))}static getDevPhrases(){return Array.from(document.querySelectorAll("[id^='"+r.idDevTemplate))}slicePhrases(e,t){var _=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?"dev_marusia_phrases":"marusia_phrases";e.slice(0,r.MAX_PHRASE_COUNT).forEach(e=>{delete t[e.id];var a=val(e);a&&t[_].push(a.trim().slice(0,r.MAX_PHRASE_LENGTH))})}saveOptions(){var e=document.getElementById("app_edit_wrap"),t="save_options",_=o({},AppsEdit.getParams(ge("app_edit_cont")),{},AppsEdit.getParams(ge("app_edit_wrap")),{act:t,marusia_phrases:[],dev_marusia_phrases:[]});if(!_.web_hook||!this.checkUrl(_.web_hook,document.getElementById("web_hook")))return Object(a.notaBene)("web_hook");this.slicePhrases(r.getPhrases(),_),this.slicePhrases(r.getDevPhrases(),_,!0);var i=Array.from(e.querySelectorAll("#app_save_btn"));for(var s in i)i[s]&&Object(a.lockButton)(i[s]);AppsEdit.saveOptionsRequest(t,_,(function(){for(var e in i)i[e]&&Object(a.unlockButton)(i[e])}))}onChangeUrl(e){var t=val(e).trim();this.checkUrl(t,e)}checkUrl(e,t){var _=document.getElementById("web_hook_notice");if(_.classList.remove("marusia_notice_shown"),!e)return!1;var a=new URL(e),i=`${a.origin.toLowerCase()}${a.pathname}${a.search}${a.hash}`;if(/^https:\/\//.test(i)){if(val(t)!==i)return val(t,i),!0}else if(_)return _.classList.add("marusia_notice_shown"),_.innerHTML=Object(s.getLang)("apps_marusia_web_hook_url_notice"),!1;return!0}createApp(e){var t=AppsEdit.getParams(!1);return t.title?t.web_hook&&this.checkUrl(t.web_hook,document.getElementById("web_hook"))?(t.type=4e3,t.hash=cur.createAppHash,void ajax.post("al_apps_edit.php",extend(t,{act:"do_create"}),{onFail:function(e){return document.getElementById("app_edit_error").innerHTML=e,e?isVisible("app_edit_error_wrap")||slideDown("app_edit_error_wrap",100):isVisible("app_edit_error_wrap")&&slideUp("app_edit_error_wrap",100),!0}})):Object(a.notaBene)("web_hook"):Object(a.notaBene)("app_title")}changeStatus(){return showBox("editapp",{act:"a_change_status_marusia",app_id:cur.aid})}doChangeStatus(e){ajax.post("editapp",{act:"a_change_status_request_marusia",app_id:cur.aid,hash:e},{onDone:function(){curBox().hide(),Object(i.hide)(document.getElementById("apps_edit_marusia_change_status")),nav.reload()},onFail:function(e){return document.getElementById("app_check_box_error").innerHTML=e,Object(i.show)("app_check_box_error"),!0}})}setPrivacy(e){Object(a.checkbox)(e),Object(a.isChecked)(e)?Object(i.show)(r.idPrivacyUsers):Object(i.hide)(r.idPrivacyUsers)}publishSkill(){return showBox("editapp",{act:"a_marusia_publish_skill",app_id:cur.aid})}doPublishSkill(e){ajax.post("editapp",{act:"a_marusia_publish_skill_request",app_id:cur.aid,hash:e},{onDone:function(e){curBox().hide(),Object(i.hide)(document.getElementById("marusia_skill_publish_btn"));var t=document.querySelector(".app_status_msg .text");t&&e&&(t.innerHTML=e)},onFail:function(e){return document.getElementById("app_check_box_error").innerHTML=e,Object(i.show)("app_check_box_error"),!0}})}}r.bodyClassName="EditMarusiaSkillPhraseBody",r.bodyDevClassName="EditMarusiaSkillDevPhraseBody",r.rowClassName="EditMarusiaSkillPhraseRow",r.addBtnContainerClassName="AppsEditAddBtnContainer",r.idTemplate="marusia_skill_phrase_",r.idDevTemplate="marusia_skill_dev_phrase_",r.idPrivacyUsers="marusia_privacy_user_ids_list",r.idAddBtn="add_marusia_trigger_phrase",r.idAddBtnDev="add_marusia_trigger_phrase_dev",r.MAX_PHRASE_LENGTH=40,r.MAX_PHRASE_COUNT=5},sjIN:function(__webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("a1Th"),core_js_modules_es6_object_to_string__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("Btvt"),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("Oyvg"),core_js_modules_es6_array_sort__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("Vd3H"),core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("OG14"),core_js_modules_es6_object_assign__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("91GP"),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("SRfc"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("pIFo"),core_js_modules_es6_array_from__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("HEwt"),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("KKXr"),_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("zxIV"),_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("v+DW"),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("EasH"),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("FWc3"),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("lXE5"),_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("4+be"),_shared_lib_convert__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("cGUQ"),_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("jE6c"),_apps_edit_sales_Sales__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("4DY8"),_apps_UploaderDistributive__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("Gb+U"),_apps_edit_Activity_ActivityMedia__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("0bzs"),_apps_edit_MarusiaSkill_MarusiaSkill__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("pujQ"),_apps_edit_Graphs_GraphsHelper__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("WupO"),_apps_edit_ModerationRequest_ModerationRequest__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("BVwM"),_shared_audio_enums__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("uk5P");function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var _=arguments[t];for(var a in _)Object.prototype.hasOwnProperty.call(_,a)&&(e[a]=_[a])}return e}).apply(this,arguments)}var AppsEdit={PANORAMIC_SLIDER_MAX_PHOTOS:5,init:function(){cur.module="apps_edit",cur.nav.push(function(e,t,_){if(void 0===e[0]&&e.section)return this.switchSection(_.section),!1}.bind(this)),this.initPage()},initPage:function(){window.Dev&&window.Dev.checkBlockHeight()},switchTab:function(e,t,_){if(!_&&checkEvent(t))return!0;if(!_&&nav.objLoc.section==e)return!1;var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_nav_"+e);if(a){var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("nav_selected",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("dev_navigation"));for(var s in i)i.hasOwnProperty(s)&&removeClass(i[s],"nav_selected");addClass(a,"nav_selected");var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("dev_left_nav");if(o&&i[0]){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("dev_left_nav_mark");setStyle(r,{height:getSize(i[0])[1],top:i[0].offsetTop||0}),addClass(o,"anim"),animate(r,{height:getSize(a)[1],top:a.offsetTop},{duration:100,onComplete:function(){removeClass(o,"anim")}})}}return _||nav.go(a,t),!1},animSubTab:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_edit_subheader"),_=t&&geByClass1("app_header_sel",t);if(t&&_){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_edit_nav_mark"),i=_&&_.offsetLeft||0,s=e.offsetLeft||0,o=s!=i?intval(70*Math.log(Math.abs(s-i)/20)):0;setStyle(a,{width:getSize(_)[0],left:i}),addClass(t,"anim"),removeClass(_,"app_header_sel"),addClass(e,"app_header_sel"),animate(a,{width:getSize(e)[0],left:s},{duration:o,transition:Fx.Transitions.easeOutCirc,onComplete:function(){removeClass(t,"anim"),setStyle(a,{display:""})}})}},switchSubTab:function(e,t){return this.animSubTab(e),nav.go(e,t)},switchSection:function switchSection(section){ajax.post("editapp",{section,id:cur.aid,load:1},{onDone:function onDone(content,script){hide("apps_edit_progress"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_edit_wrap").innerHTML=content,script&&eval(script),AppsEdit.hideError(),nav.setLoc(extend(nav.objLoc,{section})),AppsEdit.initPage(),Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_14__.scrollToTop)(0)},onFail:AppsEdit.showError})},showError:function(e,t){return!e||(hide("apps_edit_progress"),t?(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)(t),show(_),show(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.domCA)(_,".apps_edit_error_wrap"))):(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_edit_error"),show(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_edit_error_wrap")),Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_14__.scrollToTop)(200)),cur.errorShown=!0,_.innerHTML=e,!0);var _},hideError:function(){cur.errorShown&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_error_wrap").forEach(hide),cur.errorShown=!1)},showRulesBox:function(e){return!showBox("editapp",{act:"show_rules",accept:e},{cache:1,params:{width:"650px",dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},onDone:AppsEdit.hideError,onFail:AppsEdit.showError,stat:["wk.css"]})},paramsData:function(e){var t={},_=function(e){return 0==e.indexOf("app_")?e.substr(4):e},a=geByTag("input",e);for(var i in a)if(a.hasOwnProperty(i)){var s=a[i];s.id&&(t[_(s.id)]=val(s))}var o=geByTag("textarea",e);for(var r in o)if(o.hasOwnProperty(r)){var n=o[r];n.id&&n.value&&(t[_(n.id)]=val(n))}var c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("checkbox",e);for(var d in c)if(c.hasOwnProperty(d)){var p=c[d];p.id&&(t[_(p.id)]=isChecked(p)?1:0)}for(var l in window.radioBtns)window.radioBtns.hasOwnProperty(l)&&(t[_(l)]=window.radioBtns[l].val);for(var u in cur.dropDowns)cur.dropDowns.hasOwnProperty(u)&&(t[_(u)]=cur.dropDowns[u].val());return delete t.selectedItems,t},getParams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_edit_cont");return AppsEdit.paramsData(t)},generateServiceToken:function(e,t){ajax.post("al_apps_edit.php",{act:"generate_token",id:e,hash:t},{onDone:function(e){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("service_token").value=e.service_token,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("service_token_hash").value=e.service_token_hash},onFail:function(e){return AppsEdit.showError(e)}})},generateSecretKey:function(e,t,_){ajax.post("al_apps_edit.php",{act:"generate_secret_key",id:e,hash:t},{onDone:function(e){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_secret2").value=e.secret_key,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("secret_key_hash").value=e.secret_key_hash,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("service_token").value=e.service_token,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("service_token_hash").value=e.service_token_hash},onFail:function(e){return AppsEdit.showError(e)}})},showTooltipForField:function(e,t,_){var a=getSize(t);Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:_,dir:"left",width:.75*a[0],shift:[1.5*-a[1],.45*-a[1]]})},showMobileFrameTooltip:function(e){return AppsEdit.urlFocus(e,null,{noSetUrl:!0,noForceDown:!0,cls:"apps_mobile_iframe_secure_tt",slideX:0}),!1},showMobileAppleDevTeamIdTooltip:function(e){return AppsEdit.showHintTooltip(e,null,{noSetUrl:!0,noForceDown:!0,cls:"apps_mobile_iframe_secure_tt",slideX:0}),!1},saveOptions:function(e,t,_){var a,i=this.getParams("app_edit_cont");if("save_info"===e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_catalog_banner_options")){var s=this.getParams("apps_edit_catalog_banner_options");s.widget_color1&&/^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(s.widget_color1)&&(s.catalog_banner_background_color=s.widget_color1,delete s.widget_color1),s.catalog_banner_description&&s.catalog_banner_description.length>48&&(s.catalog_banner_description=s.catalog_banner_description.substr(0,48)),i=_extends({},s,{},i)}"save_info"===e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_edit_cont_extra")&&(i=_extends({},this.getParams("app_edit_cont_extra"),{},i));if(i.act=e||"save_options",i.help=Privacy.getValue("help"),"save_info"!=e){i.openapi=Privacy.getValue("openapi"),i.need_install=Privacy.getValue("install"),i.widescreen_enabled=Privacy.getValue("widescreen"),i.widescreen_type=window.radioBtns&&radioBtns.widescreen_type?radioBtns.widescreen_type.val:0,cur.privacy.push&&(i.push=Privacy.getValue("push"));var o=Privacy.getValue("require");if((o=o.split("_"))[1])for(var r in o=o[1].split(",")){if(o.hasOwnProperty(r))i["access_"+cur.maskByGroupNum[parseInt(o[r])-300]]=1}}t&&(i.confirm=1),(a=_?[_]:Array.from(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_edit").querySelectorAll("#app_save_btn"))).forEach(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton);AppsEdit.saveOptionsRequest(e,i,()=>{a.forEach(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton)},_)},showFieldError:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_"+e)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)(e);elfocus(t),setStyle(t,"backgroundColor","#FAEAEA"),setTimeout(animate.pbind(t,{backgroundColor:"#FFFFFF"},300),400)},saveOptionsRequest:function(e,t,_,a){ajax.post("editapp",t,{onDone:function(t,i,s){if(_(),hide("apps_options_saved"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_error_text")&&hide("apps_edit_error_text"),AppsEdit.hideError(),"confirm"==t)Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(i,s,Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_continue"),(function(){curBox().hide(),AppsEdit.saveOptions(e,!0)}),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_cancel"));else if("error"==t)if("domain"==s){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_addr_table");setStyle(o,"backgroundColor","#FAEAEA"),setTimeout(animate.pbind(o,{backgroundColor:"#FFFFFF"},300),400),elfocus("app_domain");var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_addr_result");r.innerHTML=i,fadeIn(r,200),Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_14__.scrollToTop)(200)}else"base_domain"==s?(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)(cur.selectDD.control.firstChild),cur.selectDD.focusInput()):isArray(s)?s.forEach((function(e){AppsEdit.showFieldError(e)})):AppsEdit.showFieldError(s);else{if(s.domain){var n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_domain");n&&(n.value=s.domain),hide("apps_addr_result")}var c;if(s.titleNotice&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_name_notice").innerHTML=s.titleNotice,show("app_name_notice"),s.titleHide?(addClass("app_name","apps_edit_input_readonly"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_name").readOnly=!0):(removeClass("app_name","apps_edit_input_readonly"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_name").readOnly=!1)),void 0!==s.canChangeGroup&&cur.dropDowns.app_group&&cur.dropDowns.app_group.disable(!s.canChangeGroup),a){var d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.domCA)(a,".dev_page_block");d&&(c=geByClass1("apps_edit_success",d)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_options_saved"))}if(c||(c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_options_saved"),Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_14__.scrollToTop)(200)),c.innerHTML=i,show(c),s.is_vk_mini_app){var p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("vk_mini_app_snippet_title"),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("vk_mini_app_snippet_subtitle"),u=geByClass1("vk_mini_app_snippet_button");p&&(p.innerText=s.app_name),l&&(l.innerText=s.description),u&&each(u,(function(e,t){t.innerText=s.button_text}))}}},onFail:function(e){var t;if(_(),hide("apps_options_saved"),a){var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.domCA)(a,".dev_page_block");t=geByClass1("apps_edit_error",i)}return AppsEdit.showError(e,t)}})},prepareVkAppUrlFields:function(e){return["iframe_url","m_iframe_secure_url","vk_app_desktop_dev_url","vk_app_dev_url"].forEach((function(t){e[t]&&(e[t]=AppsEdit.removeHash(e[t]))})),e},removeHash:function(e){var t=e.indexOf("#");return e&&~t?e.substr(0,e.indexOf("#")):e},saveVkAppOptions:function(e,t){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_edit_wrap"),a=this.getParams(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_edit_wrap"));if(a.act=e||"save_options",a.help=Privacy.getValue("help"),"save_info"!=e){a.openapi=Privacy.getValue("openapi"),a.need_install=Privacy.getValue("install"),a.widescreen_enabled=Privacy.getValue("widescreen"),a.widescreen_type=window.radioBtns&&radioBtns.widescreen_type?radioBtns.widescreen_type.val:0,cur.privacy.push&&(a.push=Privacy.getValue("push"));var i=Privacy.getValue("require");if((i=i.split("_"))[1])for(var s in i=i[1].split(",")){if(i.hasOwnProperty(s))a["access_"+cur.maskByGroupNum[parseInt(i[s])-300]]=1}}"save_options"===e&&this.prepareVkAppUrlFields(a),t&&(a.confirm=1);var o=Array.prototype.slice.call(_.querySelectorAll("#app_save_btn"));for(var r in o)o[r]&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton)(o[r]);AppsEdit.saveOptionsRequest(e,a,(function(){for(var e in o)o[e]&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton)(o[e])}))},onSnippetButtonChange:function(e){var t=cur.dropDowns.app_snippet_button_type.val_full(e)[1],_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("vk_mini_app_snippet_button");_&&t&&each(_,(function(e,_){_.innerText=t}))},saveAdsOptions:function(e,t){var _={act:"save_ads_web_settings",app_id:e,hash:t};_.ads_web_fb_interval=val("app_ads_web_fb_interval");var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_ads_save_btn");Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton)(a);var i=function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton)(a)};function s(e){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_ads_settings_error").innerHTML=e,show("apps_ads_settings_error_wrap"),scrollToY(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.getXY)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_ads_web_settings"))[1],200)}hide("apps_ads_settings_error_wrap"),hide("apps_ads_settings_save_info"),ajax.post("editapp",_,{onDone:function(e){if(i(),e.ok)e.message&&(_=e.message,(a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_ads_settings_save_info")).innerHTML=_,show(a),scrollToY(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.getXY)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_ads_web_settings"))[1],200));else{if(e.field){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_"+e.field+"_wrap")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_"+e.field);elfocus(t),setStyle(t,"backgroundColor","#FAEAEA"),setTimeout(animate.pbind(t,{backgroundColor:"#FFFFFF"},300),400)}e.error&&s(e.error)}var _,a},onFail:function(e){i(),s(e)}})},onAppAdsWebFBIntervalSliderChange:function(e){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_ads_web_fb_interval_slider_selected_val").innerHTML=e},loadCheckHistory:function(e,t){if(isVisible("apps_check_history"))hide("apps_check_history");else{if(t){if(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.actionsMenuItemLocked)(t))return;Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockActionsMenuItem)(t)}ajax.post("apps_check.php",{act:"a_check_history",no_version:1,app_id:e},{onDone:function(e){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockActionsMenuItem)(t),val("apps_check_history",e),show("apps_check_history")}})}},setMultilang:function(e,t,_,a){if(a){if(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.actionsMenuItemLocked)(a))return;Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockActionsMenuItem)(a)}ajax.post("apps_check",{act:"switch_multilang",aid:e,enabled:t,hash:_},{onDone:function(){nav.reload()}})},resetNameCounter:function(e,t){ajax.post("apps_check",{act:"a_reset_counters",aid:e,hash:t},{onDone:function(){nav.reload()}})},appWidgetAccess:function(e,t,_,a){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.actionsMenuItemLocked)(e)||(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockActionsMenuItem)(e),ajax.post("apps_check",{act:"a_app_widget_access",aid:t,val:a,hash:_},{onDone:function(){nav.reload()},onFail:_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockActionsMenuItem.pbind(e)}))},adminApp:function(e,t,_,a,i,s,o,r,n,c){var d=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(cur.appEditAdminTitle,'<div id="apps_show_penalty" style="display:none;"><div style="color:#666;padding:5px 0;">'+cur.appEditAdminPenalty+'</div><input type="text" id="apps_penalty" class="text" style="width:440px" value="'+i+'"/></div><div style="color:#666;padding:5px 0;">'+cur.appEditAdminComment+'</div><textarea id="apps_check_comment" class="dark box_textarea"></textarea>'+(o||"")+(r||"")+(n||""));d.setOptions({width:500}),i>0?show("apps_show_penalty"):hide("apps_show_penalty"),d.removeButtons(),d.addButton(a,(function(){if(!cur.adminActStarted){cur.adminActStarted=!0;var a={act:e,id:t,hash:_,penalty:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_penalty").value,comment:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_check_comment").value};o&&(a.ban_domain=isChecked("admin_app_bandomain")),r&&(a.warn_users=isChecked("admin_app_warnusers")),n&&(a[c]=isChecked("admin_custom_field")),ajax.post(s?"apps_check":"apps_check.php",a,{onDone:function(){nav.reload()},showProgress:d.showProgress,hideProgress:d.hideProgress})}}),"yes"),d.addButton(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("box_cancel"),d.hide,"no")},adminTogglePlatform:function(e,t,_,a){if(a){if(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.actionsMenuItemLocked)(a))return;Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockActionsMenuItem)(a)}var i={act:"a_toggle_platform_enabled",app_id:e,platform:t,hash:_};ajax.post("apps_check",i,{onDone:function(e){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockActionsMenuItem)(a),val(a,e)}})},uploadIcon:function(){showBox("editapp",{act:"upload_icon_box",aid:cur.aid},{params:{width:"430px",bodyStyle:"padding: 0px; position: relative;",dark:1}})},uploadDistributive:function(e){showBox("editapp",{act:"distributive_box",app_id:cur.aid,platform_id:e},{params:{preventHideLastWithCheck:!0,width:"430px",bodyStyle:"padding: 0px; position: relative;",dark:1}})},uploadPhoto:function(e){showBox("editapp",{act:"upload_photo_box",aid:cur.aid,big:e?1:0,edit_lang:cur.editLang},{params:{width:"438px",bodyStyle:"padding: 0px; position: relative;",dark:1}})},checkAddress:function(e){cur.addrUnchecked=0,clearTimeout(cur.addressCheckTO),cur.lastAddress!=val("app_domain")&&(cur.addressCheckTO=setTimeout(AppsEdit.doCheckAddress,e||0))},doCheckAddress:function(){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_addr_result");fadeOut(e,200),cur.lastAddress=val("app_domain"),hide("apps_addr_result"),ajax.post("editapp",{act:"a_check_address",name:cur.lastAddress,aid:cur.aid},{onDone:function(t){cur.addrChecked=1,e.innerHTML=t,fadeIn(e,200)},onFail:function(t){return cur.addrChecked=-1,e.innerHTML=t,fadeIn(e,200),!0}})},deleteApp:function(){showBox("editapp",{act:"delete_app_box",aid:cur.aid},{params:{dark:1,width:"430px",bodyStyle:"padding: 20px; line-height: 160%;"}})},switchToMiniApp:function(){showBox("editapp",{act:"switch_to_mini_app",app_id:cur.aid})},activateRow:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_delete_row",e);t[0].active||animate(t[0],{backgroundColor:"#C4D2E1"},200)},deactivateRow:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_delete_row",e);t[0].active||animate(t[0],{backgroundColor:"#FFF"},200)},activateDelete:function(e){e.active=!0,animate(e,{backgroundColor:"#6B8DB1"},200),Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_delete"),showdt:500})},deactivateDelete:function(e){e.active=!1,animate(e,{backgroundColor:"#C4D2E1"},200),window.tooltips&&tooltips.hide(e)},deleteSWF:function(e,t,_){var a;tooltips.hide(_);a=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_title_file_delete"),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_confirm_file_delete"),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_delete"),(function(){a.showProgress(),ajax.post("editapp",{act:"a_delete_swf",aid:cur.aid,swf_id:e,hash:t},{onDone:function(t){a.hideProgress(),a.content(t),a.removeButtons(),a.addButton(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_close"),a.hide),setTimeout(a.hide,2e3),re("apps_edit_swf_"+e);var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_swf_row",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_flash_other_options"));1==_.length&&re(_[0])}})}),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_cancel"),(function(){a.hide()}))},showHint:function(e,t,_){e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)(e);var a=cur.hint[e.id];clearTimeout(cur.hideHintTimout),t?Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:a,slide:15,className:"apps_edit_up_tt",shift:_||[0,-1,0]}):Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:'<div class="apps_edit_side_tt_pointer"></div>'+a,slideX:15,className:"apps_edit_tt",shift:_||[-291,0,-60],forcetodown:!0})},hideHint:function(e){e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)(e),clearTimeout(cur.hideHintTimout),cur.hideHintTimout=setTimeout((function(){window.tooltips&&e.tt&&e.tt.hasOwnProperty("hide")&&e.tt.hide()}),500)},showSecret:function showSecret(aid,hash){ajax.post("al_apps_edit.php",{act:"a_show_secret",aid,hash},{onDone:function onDone(title,html,js){Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(title,html),eval(js)},loader:1})},showSecretInPlace:function(e,t){ajax.post("al_apps_edit.php",{act:"a_show_secret_in_place",aid:e,hash:t},{onDone:function(e){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("secret_key_edit").innerHTML=e},loader:1})},changeType:function(e,t,_,a){var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_check_change_type_label"),s=domPN(i);if(a){if(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.actionsMenuItemLocked)(a))return;Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockActionsMenuItem)(a)}return ajax.post("apps_check",{act:"change_type",aid:e,hash:t,from:"appview",new_type:_},{onDone:function(e){uiActionsMenu.hide(s),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockActionsMenuItem)(a),val(i,e)}}),!1},getUploadErrorText:function(e,t,_){var a={apps_full_banner_error:"apps_full_banner_size_1120_error",apps_photo_error:"apps_photo_size_error",apps_catalog_image_error:"apps_catalog_image_size_278_error",apps_discover_image_error:"apps_discover_image_size_576_error",apps_downloaded_game_image_error:"apps_catalog_image_size_245_error",mini_app_catalog_banner_pic_error:"apps_mini_app_catalog_banner_pic_image_size_960_error",apps_screenshot_error:"apps_screenshot_size_error",apps_widescreen_image_error:"apps_widescreen_banner_size_error",apps_panoramic_banner_error:"apps_full_banner_size_1120_error",apps_edit_featured_banner_error:"apps_mini_app_catalog_featured_banner_image_size_1050_error"};return 105==e?_.apps_banner_size_error:-1==e?_[a[t]||_.apps_banner_size_error]:"ERR_UPLOAD_BAD_IMAGE_SIZE"==e&&"apps_panoramic_banner_error"==t?_[a[t]]:_.apps_photo_notloaded_unknown},initUpload:function initUpload(cont,opts,lang,resObj){var options={file_name:"photo",file_size_limit:5242880,file_types_description:"Image files (*.jpg, *.jpeg, *.png, *.gif)",file_types:"*.jpg;*.JPG;*.jpeg;*.JPEG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP",lang,onUploadStart:function(e,t){"form"==Upload.types[e]&&window.box&&show(window.box.progress),hide("apps_edit_upload_error")},onNoFilteredCallback:function(){if(lang){var e=Upload.obj[0],t=domPN(e);hasClass(t,"apps_edit_progress")&&removeClass(t,"apps_edit_progress"),AppsEdit.showError(lang.apps_edit_invalid_image_file,opts.errorObj)}},onUploadComplete:function onUploadComplete(i,res){var obj;try{obj=eval("("+res+")")}catch(e){obj=Object(_shared_lib_convert__WEBPACK_IMPORTED_MODULE_16__.fromQueryString)(res)}if(obj.code)Upload.onUploadError(i,obj.code);else if(obj.error)Upload.onUploadError(i,obj.error);else{opts.vars.mid&&(obj.mid=opts.vars.mid),opts.vars.vk_app_catalog_photo&&(obj.vk_app_catalog_photo=1);var params={act:opts.save_act,app_id:cur.aid};cur.editLang&&(params.edit_lang=cur.editLang),"apps_banner_error"==opts.errorObj&&hide("apps_banner_update"),ajax.post("editapp",extend(obj,params),{onDone:function(e,t){opts.success_callback?opts.vars.vk_app_catalog_photo?cur[opts.success_callback](e,t,resObj):cur[opts.success_callback](e,t):isArray(resObj)?resObj.forEach((function(t){t&&(t.src=e,addClass(resObj.parentNode,"apps_edit_img_loaded"))})):(resObj.src=e,addClass(resObj.parentNode,"apps_edit_img_loaded")),opts.lite||Upload.embed(i),opts.errorObj&&hide(opts.errorObj)},onFail:function(e){return AppsEdit.showError(e,opts.errorObj),opts.lite||Upload.embed(i),!0}})}},onUploadProgress:AppsEdit.showUploadProgress,onUploadError:function(e,t){debugLog("error",e,t);var _=AppsEdit.getUploadErrorText(t,opts.errorObj,lang),a=void 0!==e.ind?e.ind:e,i=Upload.obj[a],s=domPN(i);hasClass(s,"apps_edit_progress")&&removeClass(s,"apps_edit_progress"),Upload.embed(a),AppsEdit.showError(_,opts.errorObj)},clear:1,type:"photo",buttonClass:"secondary small",max_attempts:3,server:opts.server,error:opts.default_error,error_hash:opts.error_hash,dropbox:"apps_icon_dropbox"};return opts.lite&&(options.flash_lite=1),Upload.init(cont,opts.url,opts.vars,options)},showUploadProgress:function(e,t,_){if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("form"+e+"_progress")){var a=Upload.obj[e],i=getSize(a)[1]/2+10,s=a.firstChild;for(addClass(a.parentNode,"apps_edit_progress");s;)1==s.nodeType&&(s.id=="uploader"+e&&browser.msie?setStyle(s,{position:"relative",left:"-5000px"}):setStyle(s,{visibility:"hidden"})),s=s.nextSibling;a.appendChild(ce("div",{innerHTML:'<div class="apps_info_progress_wrap"><div id="form'+e+'_progress" class="apps_upload_progress" style="width: 0%;"></div></div></div>',className:"apps_info_prg_cont"},{height:i+"px",marginTop:-i+"px"}))}var o=intval(t/_*100);o=Math.min(o,100),setStyle(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("form"+e+"_progress"),{width:o+"%"})},hideUploadProgress:function(e){var t=void 0!==e.ind?e.ind:e,_=Upload.obj[t],a=domPN(_);hasClass(a,"apps_edit_progress")&&removeClass(a,"apps_edit_progress"),Upload.embed(t)},initAudioRows:function(){var e=domQuery(".audio_row");each(e,(e,t)=>{var _=t.dataset.fullId;geByClass1("audio_row__title_inner_subtitle",t).innerHTML="id: "+_})},initUploadAudio:function(e,t,_){var a,i={file_name:"file",file_size_limit:5242880,file_types_description:"Audio files (*.mp3)",file_types:"*.mp3;*.MP3",accept:"audio/mpeg",lang:_,onUploadStart:function(e,t){(a=geByClass1("file",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_upload_audio")))&&(a.disabled=!0),AppsEdit.hideError(),hide("apps_audio_error")},onUploadProgress:AppsEdit.showUploadProgress,onUploadComplete:function(e,_){var i;try{i=JSON.parse(_)}catch(e){i=Object(_shared_lib_convert__WEBPACK_IMPORTED_MODULE_16__.fromQueryString)(_)}if(i.code)Upload.onUploadError(e,i.code);else if(i.error)Upload.onUploadError(e,i.error);else{var s={act:"a_save_audio",app_id:cur.aid,hash:cur.audioHash,audio_meta:_};ajax.post("editapp",s,{onDone:function(t){var _=geByClass1("apps_edit_audios_list"),i=geByClass1("audio_row:first-child"),s=document.createElement("template");s.innerHTML=t,i?_.insertBefore(s.content.firstChild,i):_.appendChild(s.content.firstChild),AppsEdit.initAudioRows(),a&&(a.disabled=!1),AppsEdit.hideUploadProgress(e)},onFail:function(_){return AppsEdit.showError(_,t.errorObj),a&&(a.disabled=!1),AppsEdit.hideUploadProgress(e),!0}})}},onUploadError:function(e,_){AppsEdit.showError(_,t.errorObj),a&&(a.disabled=!1),AppsEdit.hideUploadProgress(e)},clear:1,type:"audio",buttonClass:"secondary small",max_attempts:3,error:t.default_error,use_go_uploader:!0};return Upload.init(e,t.url,t.vars,i)},showRemoveAudioTooltip:function(e){Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{black:1,text:cur.remove_audio,shift:[7,4,0],forcetoup:1})},removeAudio:function(e){var t=JSON.parse(domData(e,"audio"))[_shared_audio_enums__WEBPACK_IMPORTED_MODULE_24__.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ID],_={act:"a_remove_audio",appId:cur.aid,hash:cur.audioHash,audioId:t};ajax.post("editapp",_,{onDone:function(){fadeOut(e,200,()=>re(e))},onFail:function(e){return AppsEdit.showError(e,"apps_edit_upload_audio"),!0}})},ssOver:function(e){var t=geByClass1("apps_edit_screen_close",e);t||(t=se('<div class="apps_edit_screen_close" onmouseover="showTooltip(this, {black: 1, text: \''+cur.remove_screenshot+"', shift: [12, 2, 0], forcetoup: 1});\"></div>"),addEvent(t,"click",AppsEdit.ssClose.pbind(e,t)),cur.destroy.push((function(){removeEvent(t,"click")})),e.appendChild(t)),fadeIn(t,100)},ssClose:function(e,t,_){var a=e.getAttribute("rel");return ajax.post("editapp",{act:"a_remove_screenshot",hash:cur.photoHash,aid:cur.aid,pid:a}),fadeOut(e,200,(function(){re(e),cur.ssCount<cur.ssMax&&show("apps_edit_upload_screenshot")})),cur.ssCount-=1,cur.ssCount<cur.ssMax&&hide("apps_edit_ss_reason"),t.tt&&t.tt.destroy(),cancelEvent(_)},ssOut:function(e){var t=geByClass1("apps_edit_screen_close",e);fadeOut(t,100)},ssClick:function(e){var t=e.getAttribute("rel");showBox("editapp",{act:"show_screen",aid:cur.aid,pid:t},{dark:1})},removeFullBanner:function(e,t){hide("apps_edit_full_wrap"),geByTag1("img",geByClass1("selected",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_full_wrap"))).src=isRetina()?"/images/dquestion_v.png":"/images/dquestion_u.png",removeClass(e,"apps_edit_progress"),Upload.embed(t),ajax.post("editapp",{act:"a_clear_full_banner",hash:cur.photoHash,aid:cur.aid,format:1,edit_lang:cur.editLang})},removeMiniAppFullBanner:function(e,t){geByTag1("img",geByClass1("selected",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_full_wrap"))).src=isRetina()?"/images/dquestion_v.png":"/images/dquestion_u.png",removeClass(e,"apps_edit_progress"),Upload.embed(t),ajax.post("editapp",{act:"a_clear_full_banner",hash:cur.photoHash,aid:cur.aid,format:1,edit_lang:cur.editLang},{onDone:function(e){var t=geByClass1("mini_app_snippet_preview"),_=geByClass1("app_snippet_preview");t&&_&&(t.style.display="",_.style.display="none")}})},removeMiniAppCatalogBannerPic:function(e,t){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("catalog_banner_mock");_&&(_.classList.remove("catalog_banner_mock--bg-pic"),_.style.backgroundImage=""),hide(e.parentNode),Upload.embed(t),ajax.post("editapp",{act:"a_clear_mini_app_catalog_banner_pic",hash:cur.photoHash,app_id:cur.aid,edit_lang:cur.editLang})},certUploadBox:function(e,t){var _=(Privacy.getValue("push")||"").split("_");showBox("editapp",{act:"select_cert",aid:cur.aid,push:_[2],cert_type:t},{params:{dark:1,bodyStyle:"padding: 20px; line-height: 160%;"}})},urlFocus:function(e,t,_){_=_||{},val(e)||_.noSetUrl||val(e,"https://"),AppsEdit.showHintTooltip(e,t,_)},onFocus:function(e,t,_){_=_||{},AppsEdit.showHintTooltip(e,t,_)},showHintTooltip:function(e,t,_){_=_||{},t=t?cur[t]:domData(e,"hint");var a=!_.noforceDown,i=void 0!==_.slideX?_.slideX:15,s=_.shift||[-291,0,-60],o=_.cls||"apps_edit_tt";t&&Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:'<div class="apps_edit_side_tt_pointer"></div>'+t,className:o,slideX:i,nohide:!0,forcetodown:a,shift:s,hasover:1,onCreate:function(){removeEvent(e,"mouseout"),addEvent(e,"blur",AppsEdit.urlBlur.pbind(e))}})},showSloganTooltip:function(e,t,_){_=_||{},t=cur[t];var a=void 0!==_.slideX?_.slideX:15,i=_.shift,s=_.cls;t&&Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:'<div class="apps_edit_side_tt_pointer"></div>'+t,className:s,slideX:a,shift:i,hasover:1,forcetodown:!0})},urlBlur:function(e){"https://"==val(e)&&val(this,""),e.tt&&e.tt.hide()},addToNew:function(e,t){showBox("editapp",{act:"add_to_new_box",aid:e,hash:t},{dark:!0})},enableOrders:function(e,t,_){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("enable_orders_btn");AppsEdit.hideError(),ajax.post("editapp",{act:"enable_orders",aid:e,force:_,hash:t},{onDone:function(_,a){if(_)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_new_api_notice").innerHTML=a;else var i=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_action_confirmation"),a,Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("box_yes"),(function(){i.hide(),AppsEdit.enableOrders(e,t,1)}),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_cancel"))},onFail:function(e){return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_error"),e),!0},showProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton)(a)},hideProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton)(a)}})},checkSize:function(e,t,_){var a=val(e);a>_?(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)(e),val(e,_)):a<t?(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)(e),val(e,t)):a!=positive(a)&&(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)(e),val(e,positive(a)||630))},updateSecureUrl:function(){if(!cur.iframeSecureChanged){var e=val("app_iframe_url").replace(/^http:/,"https:").trim();val("app_m_iframe_secure_url",e)}},onChangeIFrameUrl:function(e){var t=AppsEdit.removeHash(val(e));t&&(/^http:\/\//.test(t)?val(e,t.replace(/^http:/,"https:")):/^https:\/\//.test(t)?val(e)!==t&&val(e,"https://"+t):val(e,"https://"+t))},onChangeDevUrl:function(){var e=AppsEdit.removeHash(val("vk_app_dev_url").trim());e&&val("vk_app_dev_url")!==e&&val("vk_app_dev_url",e)},onChangePreloadUrl:function(){var e=AppsEdit.removeHash(val("vk_mini_app_preload_url").trim());e&&val("vk_mini_app_preload_url")!==e&&val("vk_mini_app_preload_url",e)},onChangeDesktopDevUrl:function(){var e=AppsEdit.removeHash(val("vk_app_desktop_dev_url").trim());e&&val("vk_app_desktop_dev_url")!==e&&val("vk_app_desktop_dev_url",e)},onChangeUrl:function(e){var t=AppsEdit.removeHash(val(e).trim());t&&val(e)!==t&&val(e,t)},onChangeMobileSecureUrl:function(){var e=AppsEdit.removeHash(val("app_m_iframe_secure_url").trim());e?(/^http:\/\//.test(e)?val("app_m_iframe_secure_url",e.replace(/^http:/,"https:")):/^https:\/\//.test(e)?val("app_m_iframe_secure_url")!==e&&val("app_m_iframe_secure_url",e):val("app_m_iframe_secure_url","https://"+e),AppsEdit.showAppleInputs()):AppsEdit.hideAppleInputs()},showAppleInputs:()=>{var e=document.getElementById("apps_edit_m_apple_dev_team_id"),t=document.getElementById("apps_edit_m_apple_dev_team_name");AppsEdit.slideShow(e),AppsEdit.slideShow(t)},hideAppleInputs:()=>{var e=document.getElementById("apps_edit_m_apple_dev_team_id"),t=document.getElementById("apps_edit_m_apple_dev_team_name");AppsEdit.slideHide(e),AppsEdit.slideHide(t)},onKeyUpMobileSecureUrl:function(){val("app_m_iframe_secure_url").trim()?AppsEdit.showAppleInputs():AppsEdit.hideAppleInputs},addFunc:function(){hide("apps_edit_funcs_empty"),hide("apps_edit_funcs_not_found"),show("func_search_panel");for(var e,t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_funcs");inArray(e=Math.floor(1e7*Math.random(),cur.funcIds)););cur.funcIds.unshift(e),cur.funcInfos[e]={name:"",code:'return "Hello World";'};var _=se(rs(cur.funcRowTpl,{name:"newFunc",code:'return "Hello World";',id:e}));addClass(geByClass1("apps_edit_cont_row",_),"apps_edit_new_func"),t.insertBefore(_,t.firstChild),cur.funcsVersions[e]={last_v:1,versions:[[-1,-1]]};var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+e);addClass(a,"dev_func_loaded"),addClass(a,"dev_no_func_versions"),AppsEdit.switchEditFunc(e),geByClass1("apps_edit_cont_name",_).focus(),AppsEdit.updateFuncsSort()},removeFunc:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+e);delete cur.funcInfos[e];var _=indexOf(cur.funcIds,e);cur.funcIds.splice(_,1);var a=geByClass1("apps_edit_editor",t);if(a&&a.ace&&a.ace.destroy(),re(t.parentNode),0==cur.funcIds.length)show("apps_edit_funcs_empty"),hide("func_search_panel");else{var i=!1;for(var s in cur.funcIds)if(cur.funcIds.hasOwnProperty(s)){var o=cur.funcIds[s],r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+o);isVisible(r)&&(i=!0)}if(!i){var n=val(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_search")),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_funcs_not_found"),d=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("developers_no_funcs_found").split("{query}").join("<b>"+this.cleanStr(n)+"</b>");c.innerHTML=d,show(c)}}delete cur.funcsVersion[e],delete cur.funcsVersions[e],delete cur.funcsVersionsDD[e],delete cur.editedFuncs[e]},removeFuncVersion:function(e,t){for(var _=cur.funcsVersions[e].versions,a=-1,i=0;i<_.length;i++)if(_[i][0]==t){a=_[i+1][0];var s=_.slice(i+1);cur.funcsVersions[e].versions=_.slice(0,i).concat(s);break}AppsEdit.updateVersionsDD(e),AppsEdit.putVersionCode(e,a),cur.funcsVersions[e].disable_add==t&&(show("apps_edit_add_version"+e),delete cur.funcsVersions[e].disable_add),cur.funcsVersions[e].last_v==t&&cur.funcsVersions[e].last_v--,cur.funcsVersions[e].versions.length<=1&&addClass("func_row_"+e,"dev_no_func_versions"),delete cur.editedFuncs[e]},removeFuncBox:function(e){if(!cur.funcSaving){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+e),_=val(geByClass1("apps_edit_cont_name",t));_="execute."+_;var a,i=cur.funcsVersion[e];a=i>0?cur.lang.developers_func_remove_confirm.replace("{v}",i).replace("{name}",clean(_)):cur.lang.developers_remove_func_confrim.replace("%s",clean(_));var s=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:cur.lang.developers_remove_func,dark:1},a,cur.lang.developers_do_remove,(function(){cur.funcSaving=!0;var t=cur.funcInfos[e],_={act:"save_func",aid:cur.aid,hash:cur.funcsHash,old_name:t.name};cur.funcsVersion[e]>0&&(_.act="a_remove_func_version",_.v=i,AppsEdit.removeFuncVersion(e,i)),ajax.post("editapp",_,{onDone:function(t,_,a){i>0||AppsEdit.removeFunc(e),cur.funcSaving=!1},onFail:function(e,t){cur.funcSaving=!1}}),s.hide()}),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_cancel"))}},initVersionDropdown:function(e){cur.verDD||(cur.verDD={}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_const_v_"+e).value=cur.lastVersion,cur.verDD[e]=new Dropdown(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_const_v_"+e),cur.versions,{width:118,big:1,selectedItem:cur.lastVersion})},saveFunc:function(e,t,_){if(!cur.funcSaving){cur.funcSaving=!0,e&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton)(e);var a=cur.funcInfos[t],i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+t),s=geByClass1("apps_edit_cont_name",i),o=geByClass1("apps_edit_editor",i);if(!o||!o.ace)return Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton)(e),void(cur.funcSaving=!1);var r=o.ace.getValue(),n=val(s),c={act:"save_func",aid:cur.aid,hash:cur.funcsHash,name:n,code:r,old_name:a.name};if(cur.funcsVersion[t]>0){c.act="a_save_func_version",c.func=a.name,c.v=cur.funcsVersion[t];for(var d=cur.funcsVersions[t].versions,p=0;p<d.length;p++)if(d[p][0]==cur.funcsVersion[t]){cur.funcsVersions[t].versions[p][1]=r;break}}else cur.funcInfos[t].code=r;ajax.post("editapp",c,{onDone:function(_,d){if("name"==_)Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)(s);else if("code"==_){var p=geByClass1("apps_edit_err_info",i);p.innerHTML=d,isVisible(p.parentNode)||slideDown(p.parentNode,150),o.ace.focus()}else if("limit"==_)Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:cur.lang.box_error,dark:1},d);else{c.v&&-1!=c.v?c.v==cur.funcsVersions[t].disable_add&&(delete cur.funcsVersions[t].disable_add,show("apps_edit_add_version"+t)):(a.name=n,a.code=r);var l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_err_info_cont",i);for(var u in l)isVisible(l[u])&&slideUp(l[u],150);var h=geByClass1("apps_edit_cancel_button",i);fadeOut(h,150,(function(){var e=geByClass1("apps_edit_save_info",i);e.innerHTML=_,fadeIn(e,150),setTimeout((function(){fadeOut(e,150,(function(){fadeIn(h,150)}))}),2e3)})),removeClass(i,"apps_edit_new_func"),cur.needSaveSort[t]&&(i=i.parentNode,delete cur.needSaveSort[t],AppsEdit.saveFuncsPosition(i,!1,i.previousSibling))}e&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton)(e),delete cur.editedFuncs[t],cur.funcSaving=!1,cur.funcsSaveCallbacks[t]&&(cur.funcsSaveCallbacks[t](),delete cur.funcsSaveCallbacks[t])},onFail:function(t,_,a){e&&(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton)(e),cur.funcSaving=!1)},loader:!!_})}},cancelFuncChange:function(e){if(!cur.funcSaving){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+e),_=val(geByClass1("apps_edit_cont_name",t)),a=geByClass1("apps_edit_editor",t),i="";a&&a.ace&&(i=a.ace.getValue());var s=cur.funcInfos[e];if(s.name||s.code!=i)if(_==s.name&&s.code==i||cur.funcsVersion[e]>0)AppsEdit.switchEditFunc(e);else var o=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:cur.lang.developers_cancel_func,dark:1},cur.lang.developers_cancel_func_confrim.replace("%s",clean(_)),cur.lang.developers_do_cancel,(function(){s.name?(a&&a.ace&&(a.ace.setValue(s.code.replace(/\_\!\_/g,"<!>"),1),a.ace.focus()),geByClass1("apps_edit_cont_name",t).value=s.name?s.name:"newFunc"):AppsEdit.removeFunc(e);o.hide()}));else AppsEdit.removeFunc(e)}},runFunc:function(e,t){if(!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.isButtonLocked)(t)){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+e),a=geByClass1("apps_edit_editor",_),i="";if(a&&a.ace&&(i=a.ace.getValue()),cur.runContProgress)return!1;for(var s={act:"a_run_method",method:"execute",param_code:i,hash:cur.runHash,aid:cur.aid},o=AppsEdit.getExecuteFields(_),r=geByClass1("apps_edit_params",_),n=0;n<o.length;n++){var c=o[n],d=geByClass1("execute_param_"+c,r),p=geByClass1("execute_field_input",d);s["param_"+c]=val(p)}cur.verDD[e]&&(s.param_v=cur.verDD[e].val()),ajax.post("dev",s,{onDone:function(e){var t=parseJSON(e),_=window.Dev.wrapObject(t,!0);Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:cur.lang.developers_run_result,dark:1,width:500,bodyStyle:"padding: 16px 16px 16px 2px;"},'<div id="dev_result" onmousemove="Dev.resultMove(event.target);" onmouseout="Dev.resultMove(false);">'+_+"</div>")},onFail:function(e){return e='<pre style="white-space:normal;word-wrap:break-word;">'+clean(e.replace(/^<pre>|<\/pre>$/g,""))+"</pre>",setTimeout(Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_error"),e).hide,2e3),!0},showProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton)(t)},hideProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton)(t)},stat:["dev.js","dev.css"]})}},adjustHeight:function(e,t){for(var _=e.renderer.lineHeight<=1?16:e.renderer.lineHeight,a=e.getSession().getScreenLength()*_+e.renderer.scrollBar.width,i=domPN(t);!hasClass(i,"apps_edit_cont_row");)i=domPN(i);var s=geByClass1("apps_edit_run_wrap",i);a=Math.max(122,a,getSize(s)[1]+26),setStyle(domPN(t),{height:a}),e.resize()},initEditor:function(e,t){var _=window.ace.edit(e);e.ace=_,_.on("change",(function(){AppsEdit.updateExecuteParams(_,e),cur.editedFuncs[t]=1}));var a=_.getSession();a.setMode("ace/mode/javascript"),a.setUseWorker(!1),a.setOptions({tabSize:2,useSoftTabs:!0}),this.adjustHeight(_,e),a.on("tokenizerUpdate",(function(){AppsEdit.updateExecuteParams(_,e)}))},getExecuteFields:function(e){for(var t=geByClass1("apps_edit_params",e).childNodes,_=[],a=0;a<t.length;a++){if(t[a].className){var i=t[a].className.match(/(?:\\s|^)execute_param_(.+)(?:\\s|$)/);i&&i[1]&&_.push(i[1])}}return _},updateExecuteParams:function(e,t){for(var _=domPN(t);!hasClass(_,"apps_edit_cont_row");)_=domPN(_);var a=AppsEdit.getExecuteFields(_);e.session.getLength();for(var i,s=new(0,window.ace.require("ace/token_iterator").TokenIterator)(e.getSession(),0,0),o=[],r=[],n=-100,c=-100,d=-1;i=s.stepForward();)if(d++,"identifier"==i.type&&"Args"==i.value&&(n=d),"punctuation.operator"==i.type&&"."==i.value&&(c=d),"identifier"==i.type&&n==d-2&&c==d-1){var p=i.value;o.indexOf(p)<0&&(o.push(p),a.indexOf(p)<0&&r.push(p))}for(var l=[],u=0;u<a.length;u++){var h=a[u];o.indexOf(h)<0&&l.push(h)}if(1==r.length&&1==l.length){var b=l[0],E=r[0],m=geByClass1("execute_param_"+b,_);removeClass(m,"execute_param_"+b),addClass(m,"execute_param_"+E),geByClass1("execute_field_name",m).innerHTML=E}else{for(var g=geByClass1("apps_edit_params",_),v=0;v<l.length;v++){var O=l[v],f=geByClass1("execute_param_"+O,g);g.removeChild(f)}for(var w=0;w<r.length;w++){var P=r[w],D=ce("div",{className:"execute_param_"+P,innerHTML:"<div class='execute_field_name'>"+P+"</div><input class='text execute_field_input' type='text'>"});g.appendChild(D)}}this.adjustHeight(e,t)},closeEditFunc:function(){if(cur.currentFunc){hide("apps_edit_add_version"+cur.currentFunc);var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+cur.currentFunc);if(e){removeClass(e,"active");var t=geByClass1("apps_edit_cont_name",e);setTimeout((function(){t.readOnly=!0}),0);var _=geByClass1("apps_edit_content",e);slideUp(_,150,(function(){AppsEdit.updateFuncsSort()}))}}},onDestroyFuncs:function(e,t,_,a){if(cur.leaving)return delete cur.leaving,void delete cur.editedFuncs;var i=[];for(var s in cur.editedFuncs)cur.editedFuncs[s]&&i.push(cur.funcInfos[s].name);if(0==i.length)return!0;cur.dev_prev_sec=nav.objLoc.section,AppsEdit.switchTab("functions",{},1);var o=cur.lang.developers_func_nosaved_confirm.replace("%s",i.join(", ")),r=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_warning"),dark:1},o,Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_continue"),(function(){cur.leaving=!0,r.hide(),cur.onContinueCb&&cur.onContinueCb()}),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_cancel"),(function(){r.hide(),cur.onCancelCb&&cur.onCancelCb()}));return cur.onContinueCb=function(){nav.go(_),"editapp"==_[0]&&AppsEdit.switchTab(_.section,{},1)},!1},initFuncsSort:function(){cur.sorter&&cur.sorter.destroy(),setTimeout((function(){cur.qsorterNoOperaStyle=!0,cur.qsorterRowClass="apps_edit_sortable_row clear_fix ",cur.qsorterRowUpClass="apps_edit_sortable_row apps_edit_sortable_row_up",cur.sorter=window.qsorter.init(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_funcs"),{width:665,height:62,xsize:1,dragEls:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_sortable_row",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_funcs")),canDrag:function(e){return!(cur.disableSort||hasClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_cont_row",e)[0],"active")||cur.currentFunc)},onReorder:AppsEdit.saveFuncsPosition,noMoveCursor:1})}),100)},updateFuncsSort:function(){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_funcs");window.qsorter.update(e,{dragEls:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_sortable_row",e)})},switchEditFunc:function(e,t){if(t){var _=t.target;for(cancelEvent(t);_;){if(hasClass(_,"apps_edit_ver_dd"))return;_=_.parentNode}}if(!cur.funcDDShown||e!=cur.funcDDShown){if(AppsEdit.closeEditFunc(),cur.initedFunctions[e]||(AppsEdit.initEditor(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_editor",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+e))[0],e),AppsEdit.initVersionDropdown(e),cur.initedFunctions[e]=1,AppsEdit.loadFuncVersions(e),cur.funcsVersionsDD[e]=new Dropdown(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("funcs_versions_dd"+e),[],{width:200,big:1,autocomplete:!0,multiselect:!1,placeholder:cur.lang.developers_search_version,onChange:function(t){t&&AppsEdit.checkSaveFuncs(e,t)},onBlur:function(){setTimeout((function(){cur.funcDDShown=!1}),500)}})),cur.currentFunc==e)return cur.currentFunc=null,void(cur.disableSort||removeClass("apps_edit_funcs","apps_edit_no_sortable"));addClass("apps_edit_funcs","apps_edit_no_sortable"),cur.funcsVersions[e]&&!cur.funcsVersions[e].disable_add&&show("apps_edit_add_version"+e),cur.currentFunc=e;var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+e);addClass(a,"active"),geByClass1("apps_edit_cont_name",a).readOnly=!1;var i=geByClass1("apps_edit_content",a);slideDown(i,150,(function(){var t=geByClass1("apps_edit_editor",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+e));t&&t.ace&&(AppsEdit.adjustHeight(t.ace,t),AppsEdit.updateExecuteParams(t.ace,t))}))}},checkSaveFuncs:function(e,t){if(cur.editedFuncs[e])var _=new MessageBox({title:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_warning"),dark:1}).content(cur.lang.developers_confirmation_sh_func).addButton(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("box_yes"),(function(){cur.funcsSaveCallbacks[e]=function(){delete cur.editedFuncs[e],AppsEdit.putVersionCode(e,t)},AppsEdit.saveFunc(!1,e,1),_.hide()})).addButton(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("box_no"),(function(){AppsEdit.putVersionCode(e,t),_.hide()}),"gray").show();else AppsEdit.putVersionCode(e,t)},loadFuncVersions:function(e){if(!cur.funcsVersions[e]){var t=cur.funcInfos[e];ajax.post("al_apps_edit.php",{act:"a_get_func_versions",func:t.name,aid:cur.aid},{onDone:function(t){t||(t={last_v:1,versions:[[-1,-1]]}),cur.funcsVersions[e]={last_v:t.last_v,versions:t.versions},AppsEdit.updateVersionsDD(e),cur.funcsVersionsDD[e].val(-1);var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+e);addClass(_,"dev_func_loaded"),t.versions.length<=1?addClass(_,"dev_no_func_versions"):show("apps_edit_add_version"+e)}})}},addFuncVersion:function(e,t){if(!(!t&&cur.funcsSaveCallbacks[e]||cur.funcsVersions[e].disable_add))if(cur.editedFuncs[e]){function _(t){a.hide(),hasClass(t,"secondary")?(delete cur.editedFuncs[e],AppsEdit.addFuncVersion(e,1)):(cur.funcsSaveCallbacks[e]=function(){delete cur.editedFuncs[e],AppsEdit.addFuncVersion(e,1)},AppsEdit.saveFunc(!1,e,1))}var a=new MessageBox({title:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_warning"),dark:1}).content(cur.lang.developers_confirmation_sh_func).addButton(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("box_yes"),_).addButton(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("box_no"),_,"gray").show()}else{cur.funcsVersions[e].last_v++;var i=cur.funcsVersions[e].last_v,s=AppsEdit.getFuncVersionCode(e,cur.funcsVersions[e].versions[0][0]);cur.funcsVersions[e].versions.unshift([i,s]),AppsEdit.updateVersionsDD(e),AppsEdit.putVersionCode(e,i),removeClass("func_row_"+e,"dev_no_func_versions"),hide("apps_edit_add_version"+e),cur.funcsVersions[e].disable_add=i}},saveFuncsPosition:function(){var e=[],t=arguments;if(hasClass(geByClass1("apps_edit_cont_row",t[0]),"apps_edit_new_func")){var _=parseInt(t[0].id.replace("func_sort",""));cur.needSaveSort[_]=!0}else{var a;for(var i in t[2]&&1==t[2].nodeType&&hasClass(geByClass1("apps_edit_cont_row",t[2]),"apps_edit_new_func")&&(t[2]=t[2].previousSibling),t)t.hasOwnProperty(i)&&(a=t[i]&&1==t[i].nodeType?geByClass1("apps_edit_cont_name",t[i]).value:null,e.push(a));ajax.post("al_apps_edit.php",{act:"a_resort_funcs",aid:cur.aid,list:e.join(",")},{onDone:function(){}})}},showVersionsDD:function(e){show("apps_edit_ver_dd"+e),cur.funcsVersionsDD[e].focus(),cur.funcDDShown=e,cur.funcsVersions[e]&&!cur.funcsVersions[e].disable_add&&show("apps_edit_add_version"+e)},updateVersionsDD:function(e){for(var t=cur.funcsVersions[e].versions,_=[],a=0;a<t.length;a++)_.push([t[a][0],cur.lang.developers_version_pref+" "+Math.abs(t[a][0])]);cur.funcsVersionsDD[e].select.clear(),cur.funcsVersionsDD[e].setData(_)},getFuncVersionCode:function(e,t){var _;if(-1==t)_=cur.funcInfos[e].code.replace(/\_\!\_/g,"<!>");else for(var a=cur.funcsVersions[e].versions,i=0;i<a.length;i++)if(a[i][0]==t){_=a[i][1];break}return _},putVersionCode:function(e,t){var _=AppsEdit.getFuncVersionCode(e,t);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_remove_btn"+e).innerHTML=-1==t?cur.lang.developers_func_remove:cur.lang.developers_remove_func_version,cur.funcsVersion[e]=parseInt(t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_editor",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+e))[0].ace.setValue(_),delete cur.editedFuncs[e],delete cur.funcsSaveCallbacks[e],cur.funcsVersionsDD[e].val(t)},switchEditActivity:function(e,t){if(void 0===t&&(t=150),cur.currentActivity){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("activity_row_"+cur.currentActivity);if(_){removeClass(_,"active");var a=geByClass1("apps_edit_content",_);slideUp(a,t)}}if(cur.currentActivity!=e){cur.currentActivity=e;var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("activity_row_"+e);addClass(i,"active");var s=geByClass1("apps_edit_content",i);slideDown(s,t,(function(){var t=geByClass1("apps_edit_editor",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+e));t&&t.ace&&AppsEdit.adjustHeight(t.ace,t)}))}else cur.currentActivity=null},switchEditRequest:function(e,t){if(void 0===t&&(t=150),cur.currentRequest){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("request_row_"+cur.currentRequest);if(_){removeClass(_,"active");var a=geByClass1("apps_edit_cont_name",_);setTimeout((function(){a.readOnly=!0}),0);var i=geByClass1("apps_edit_content",_);slideUp(i,t)}}if(cur.currentRequest!=e){cur.currentRequest=e;var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("request_row_"+e);addClass(s,"active");var o=geByClass1("apps_edit_cont_name",s);o&&(o.readOnly=!1);var r=geByClass1("apps_edit_content",s);slideDown(r,t,(function(){var t=geByClass1("apps_edit_editor",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("func_row_"+e));t&&t.ace&&AppsEdit.adjustHeight(t.ace,t)}))}else cur.currentRequest=null},collectRequestData:function(e){return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("request_row_"+e)?{name:trim(val("request_name_"+e)),text_m:trim(val("request_text_m_"+e)),text_f:trim(val("request_text_f_"+e)),text_mul:trim(val("request_text_mul_"+e)),button:trim(val("request_accept_text_"+e)),response:!!isChecked("request_response_"+e)}:{}},collectActivityData:function(e){if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("activity_row_"+e))return{};var t={name:trim(val("activity_text_name_"+e)),text_m:trim(val("activity_text_m_"+e)),text_f:trim(val("activity_text_f_"+e)),points:parseInt(trim(val("activity_text_points_"+e)))};return AppsEdit.activityMedia&&(t.media=JSON.stringify(AppsEdit.activityMedia.getMediaForSave(e))),t},checkActivityFields:function(e){var t=this.collectActivityData(e);return t.name?t.text_m?t.text_f?t.points?(t.response=t.response?1:0,t):(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)(domPN(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("activity_text_points_"+e))),elfocus("activity_text_mul_"+e),!1):(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)(domPN(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("activity_text_f_"+e))),elfocus("activity_text_f_"+e),!1):(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)(domPN(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("activity_text_m_"+e))),elfocus("activity_text_m_"+e),!1):(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)("activity_name_"+e),t.name&&this.showRequestMsg(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("activity_row_"+e),!0,Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_wrong_activity_name")),!1)},checkRequestFields:function(e){var t=this.collectRequestData(e);return t.name.match(/^([a-zA-Z0-9_]+)$/)?t.text_m?t.text_f?t.text_mul?t.button?(t.response=t.response?1:0,t):(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)("request_accept_text_"+e),!1):(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)(domPN(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("request_text_mul_"+e))),elfocus("request_text_mul_"+e),!1):(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)(domPN(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("request_text_f_"+e))),elfocus("request_text_f_"+e),!1):(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)(domPN(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("request_text_m_"+e))),elfocus("request_text_m_"+e),!1):(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.notaBene)("request_name_"+e),t.name&&this.showRequestMsg(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("request_row_"+e),!0,Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_wrong_request_name")),!1)},requestNotModified:function(e){var t=cur.requests[e]||this.defaultRequestData(),_=this.collectRequestData(e);for(var a in _)if(_.hasOwnProperty(a)&&t[a]!==_[a])return!1;return!0},activityNotModified:function(e){if(cur.activityChanged=cur.activityChanged||{},!cur.activities[e]&&!cur.activityChanged[e])return!0;var t=cur.activities[e],_=this.collectActivityData(e);if(!t)return!1;for(var a in _)if(_.hasOwnProperty(a)&&t[a]!==_[a])return!1;return!0},defaultRequestData:function(){return{name:"newRequest",text_m:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_sent_request_m"),text_f:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_sent_request_f"),text_mul:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_sent_request_mul"),button:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_request_button_accept"),response:!1}},defaultActivityData:function(){var e=unclean(cur.activitySamples).split("<#>");return{name:(e=e[Math.floor(Math.random()*e.length)].split("<!>"))[0],text_m:e[1],text_f:e[2],points:10}},updateRemainingPoints:function(){var e=0;each(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_activity_points"),(function(){e+=parseInt(val(this))||0}));var t=Math.max(cur.maxTotalPoints-e,0),_=langNumeric(t,cur.lang.apps_activities_edit_points_remain);return each(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_points_remain_text"),(function(){this.innerHTML=_})),cur.activityRemainPoints=t,cur.maxTotalPoints-e},toggleRequestsBtn:function(){toggle("add_requests_btn",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_cont_row",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_requests")).length<cur.maxRequests)},toggleActivitiesBtn:function(){toggle("add_activities_btn",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_cont_row",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_activities")).length<cur.maxActivities)},requestInsertRow:function(e,t){if(e&&t){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_cont_row",t),a=parseInt(e.id.replace("request_row_","")),i=!1;for(var s in _){if(_.hasOwnProperty(s))if(parseInt(_[s].id.replace("request_row_",""))<a){i=_[s];break}}i?t.insertBefore(e,i):t.appendChild(e)}},activityInsertRow:function(e,t){if(e&&t){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_cont_row",t),a=parseInt(e.id.replace("activity_row_","")),i=!1;for(var s in _){if(_.hasOwnProperty(s))if(parseInt(_[s].id.replace("activity_row_",""))<a){i=_[s];break}}i?t.insertBefore(e,i):t.appendChild(e)}},onActivityInputsChange:function(e,t){var _=gpeByClass("apps_edit_cont_row",e);if(_){var a=_.getAttribute("data-id");a>2e9&&(cur.activityChanged=cur.activityChanged||{},cur.activityChanged[a]=!0);var i=geByClass1("apps_edit_activity_name",_),s=geByClass1("apps_edit_activity_points",_),o=geByClass1("apps_edit_activity_title_name",_),r=geByClass1("apps_edit_activity_title_points",_),n=parseInt(val(s))||0;(n>cur.maxPointsPerActivity||n<0)&&val(s,Math.max(0,Math.min(cur.maxPointsPerActivity,n))),clearTimeout(cur._activityInputChangeTO),cur._activityInputChangeTO=setTimeout((function(){o.innerHTML=clean(trim(i.value)||Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_activities_unnamed")),r.innerHTML=clean(langNumeric(trim(s.value)||0,cur.lang.apps_edit_activities_points)||"")}),50)}},initActivities:function(e,t,_,a,i,s,o,r,n,c){Object.assign(window.cur,{activities:t,activityRowTpl:e,activityHash:_,maxActivities:s,maxTotalPoints:o,maxPointsPerActivity:r,activitySamples:i}),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.addLangKeys)(a),c?(this.activityMedia=new _apps_edit_Activity_ActivityMedia__WEBPACK_IMPORTED_MODULE_20__.default(n),this.activityMedia.init(t)):this.activityMedia=null,AppsEdit.updateRemainingPoints()},addActivity:function(){hide("apps_edit_activity_empty"),hide("apps_edit_activity_not_found"),cur.activityId=(cur.activityId||2e9)+1;var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_activities_new"),t=cur.activityId,_=this.rowFromActivity(t,this.defaultActivityData());AppsEdit.requestInsertRow(_,e),show(e),AppsEdit.toggleRequestsBtn(),AppsEdit.switchEditRequest(t),AppsEdit.updateRemainingPoints(),geByClass1("apps_edit_activity_name",_).select(),re(geByClass1("apps_edit_activity_delete_btn",_)),AppsEdit.activityMedia&&AppsEdit.activityMedia.initPhotoUpload(t)},addRequest:function(){hide("apps_edit_requests_empty"),hide("apps_edit_requests_not_found"),cur.requestId=(cur.requestId||2e9)+1;var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_requests_new"),t=cur.requestId,_=this.rowFromRequest(t,this.defaultRequestData());AppsEdit.requestInsertRow(_,e),show(e),AppsEdit.toggleRequestsBtn(),AppsEdit.switchEditRequest(t),geByClass1("apps_edit_cont_name",_).focus()},showRequestMsg:function(e,t,_){var a=geByClass1("apps_edit_cancel_button",e);return fadeOut(a,150,(function(){var i=geByClass1("apps_edit_save_info",e);t&&(_='<span class="save_error">'+_+"</span>"),i.innerHTML=_,fadeIn(i,150),setTimeout((function(){fadeOut(i,150,fadeIn.pbind(a,150))}),2e3)})),!0},showRequestUserTT:function(e,t){var _=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)(t||"apps_edit_request_user_name");Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:'<div class="apps_edit_bottom_tt_pointer"></div>'+_,className:"apps_edit_tt user",slide:15,shift:[1,9,9]})},showActivityUserTT:function(e,t,_){var a=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)(t||"apps_edit_request_user_name");Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:'<div class="apps_edit_bottom_tt_pointer"></div>'+a,className:"apps_edit_tt user",slide:15,shift:_||[1,9,9]})},showRequestStatusTT:function(e,t){var _=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_edit_request_created"),a=cur.requests[t];if(a){switch(a.status){case 0:_=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_edit_request_created");break;case 1:_=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_edit_request_accepted");break;case 2:_=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_edit_request_declined")}window.tooltips&&tooltips.hideAll(),Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:'<div class="apps_edit_bottom_tt_pointer"></div>'+_,className:"apps_edit_tt user",slide:15,shift:[17,15,15]})}},showActivityStatusTT:function(e,t){var _=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_edit_activity_created"),a=cur.activities[t];if(a){switch(a.status){case 0:_=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_edit_activity_created");break;case 1:_=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_edit_activity_accepted");break;case 2:_=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_edit_activity_declined")}window.tooltips&&tooltips.hideAll(),Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:'<div class="apps_edit_bottom_tt_pointer"></div>'+_,className:"apps_edit_tt user apps_edit_tt_left",slide:15,forcetoleft:!0,shift:[207,15,15]})}},rowFromRequest:function(e,t){var _="";switch(t.status){case 0:_="review";break;case 1:_="accepted";break;case 2:_="declined"}var a={id:e,row_class:_,name:t.name,text_m:t.text_m,text_f:t.text_f,text_mul:t.text_mul,button:t.button,check_class:t.response?" on":"",disabled_attr:1==t.status?' disabled="disabled"':"",disabled_class:1==t.status?" disabled":""};return se(rs(cur.requestRowTpl,a))},rowFromActivity:function(e,t,_){var a="";switch(t.status){case 0:a="review";break;case 1:a="accepted";break;case 2:a="declined"}var i={id:e,row_class:a,name:t.name,text_m:t.text_m,text_f:t.text_f,points:t.points,points_text:langNumeric(t.points,cur.lang.apps_edit_activities_points),check_class:t.response?" on":"",disabled_attr:1==t.status?' disabled="disabled"':"",disabled_class:1==t.status?" disabled":"",id_hide_style:_?"":"display: none",points_label_hide_style:_?"":"display: none",disabled_points_attr:1==t.status?" ":"",disabled_points_class:1==t.status?" ":"",media_image_src:_apps_edit_Activity_ActivityMedia__WEBPACK_IMPORTED_MODULE_20__.default.getPhotoSrc(e),media_modifier:_apps_edit_Activity_ActivityMedia__WEBPACK_IMPORTED_MODULE_20__.default.getModifier(e)};return se(rs(cur.activityRowTpl,i))},saveActivity:function(e,t){var _=this.checkActivityFields(t);if(_&&!cur.activitySaving){cur.activitySaving=!0,e&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton)(e);var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("activity_row_"+t),i=extend({act:"save_activity",aid:cur.aid,hash:cur.activityHash,activity_id:t},_);ajax.post("editapp",i,{onDone:function(e,_,i){var s=cur.activities[e],o=AppsEdit.activityRowsCnt();cur.activities[e]=_;var r=AppsEdit.rowFromActivity(e,_,!0),n=domPN(a),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_activities_status"+_.status);n.id==c.id&&s&&s.status==_.status?n.replaceChild(r,a):(AppsEdit.removeActivity(t,!0),AppsEdit.activityInsertRow(r,c),show(c)),cur.currentActivity=null,t==e?AppsEdit.switchEditActivity(e,0):1==o&&AppsEdit.showActivityStatusTT(geByClass1("apps_edit_cont_icon",r),e),AppsEdit.showRequestMsg(r,!1,i),AppsEdit.updateRemainingPoints(),AppsEdit.activityMedia&&AppsEdit.activityMedia.onChangeActivity(e),AppsEdit.activityMedia&&AppsEdit.activityMedia.initPhotoUpload(e)},onFail:AppsEdit.showRequestMsg.pbind(a,!0),hideProgress:function(){e&&(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton)(e),cur.activitySaving=!1)}})}},toggleActivity:function(e,t){var _=gpeByClass("apps_edit_cont_row",e),a=geByClass1("apps_edit_content",_);toggle(a)},saveRequest:function(e,t){var _=this.checkRequestFields(t);if(_&&!cur.requestSaving){cur.requestSaving=!0,e&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton)(e);var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("request_row_"+t),i=extend({act:"save_request",aid:cur.aid,hash:cur.requestHash,request_id:t},_);ajax.post("editapp",i,{onDone:function(e,_,i){var s=cur.requests[e],o=AppsEdit.requestRowsCnt();cur.requests[e]=_;var r=AppsEdit.rowFromRequest(e,_),n=domPN(a),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_requests_status"+_.status);n.id==c.id&&s&&s.status==_.status?n.replaceChild(r,a):(AppsEdit.removeRequest(t,!0),AppsEdit.requestInsertRow(r,c),show(c)),cur.currentRequest=null,t==e?AppsEdit.switchEditRequest(e,0):1==o&&AppsEdit.showRequestStatusTT(geByClass1("apps_edit_cont_icon",r),e),AppsEdit.showRequestMsg(r,!1,i)},onFail:AppsEdit.showRequestMsg.pbind(a,!0),hideProgress:function(){e&&(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton)(e),cur.requestSaving=!1)}})}},correctActivityPointsInput:function(e){var t=parseInt(val(e))||0;val(e,t)},cancelActivityChange:function(e){if(!cur.activitySaving){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("activity_row_"+e),_=cur.activities[e],a=geByClass1("apps_edit_content",t),i=geByClass1("apps_edit_activity_title_name",t);if(AppsEdit.activityNotModified(e))_?toggle(a):AppsEdit.removeActivity(e);else var s=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_cancel_activity"),dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_cancel_activity_confrim"),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("developers_do_cancel"),(function(){_?((Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("activity_text_m_"+e)||{}).value=unclean(_.text_m),(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("activity_text_f_"+e)||{}).value=unclean(_.text_f),(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("activity_text_name_"+e)||{}).value=unclean(_.name),val("activity_points_"+e,_.points),val(i,trim(_.name)||Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_activities_unnamed")),AppsEdit.activityMedia&&AppsEdit.activityMedia.revertChanges(e),toggle(a)):AppsEdit.removeActivity(e),s.hide()}))}},cancelRequestChange:function(e){if(!cur.requestSaving){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("request_row_"+e),_=val(geByClass1("apps_edit_cont_name",t)),a=cur.requests[e];if(AppsEdit.requestNotModified(e))a?AppsEdit.switchEditRequest(e):AppsEdit.removeRequest(e);else var i=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_cancel_request"),dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_cancel_request_confrim").replace("%s",clean(_)),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("developers_do_cancel"),(function(){a?(val("request_name_"+e,a.name),val("request_text_m_"+e,a.text_m),val("request_text_f_"+e,a.text_f),val("request_text_mul_"+e,a.text_mul),val("request_accept_text_"+e,a.button),checkbox("request_response_"+e,a.response)):AppsEdit.removeRequest(e),i.hide()}))}},activityRowsCnt:function(e){return e||(e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_activities")),(e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_cont_row",e)||[]).length},requestRowsCnt:function(e){return e||(e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_requests")),(e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_cont_row",e)||[]).length},removeRequest:function(e,t){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("request_row_"+e),a=domPN(_);re(_);var i=AppsEdit.requestRowsCnt(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_requests"));AppsEdit.requestRowsCnt(a)||hide(a),t||(delete cur.requests[e],AppsEdit.toggleRequestsBtn(),i||show("apps_edit_requests_empty"))},removeActivity:function(e,t){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("activity_row_"+e),a=domPN(_);re(_);var i=AppsEdit.activityRowsCnt(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_requests")),s=AppsEdit.activityRowsCnt(a);AppsEdit.activityMedia&&AppsEdit.activityMedia.onChangeActivity(e),s||hide(a),t||(delete cur.activities[e],AppsEdit.toggleActivitiesBtn(),i||show("apps_edit_activities_empty"))},removeActivityBox:function(e){if(cur.activitySaving)return!1;var t=cur.activities[e];if(!AppsEdit.activityNotModified(e)||t)var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("activity_row_"+e),a=val(geByClass1("apps_edit_cont_name",_)),i=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_remove_activity"),dark:1},Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_remove_activity_confirm").replace("%s",clean(a)),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("developers_do_remove"),(function(){t?(cur.activitySaving=!0,ajax.post("editapp",{act:"delete_activity",aid:cur.aid,hash:cur.activityHash,activity_id:e},{onDone:AppsEdit.removeActivity.pbind(e,!1),onFail:AppsEdit.showRequestMsg.pbind(_,!0),hideProgress:function(){cur.activitySaving=!1}})):AppsEdit.removeActivity(e),i.hide()}),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_cancel"));else AppsEdit.removeActivity(e)},removeRequestBox:function(e){if(cur.requestSaving)return!1;var t=cur.requests[e];if(!AppsEdit.requestNotModified(e)||t)var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("request_row_"+e),a=val(geByClass1("apps_edit_cont_name",_)),i=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_remove_request"),dark:1},Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_remove_request_confrim").replace("%s",clean(a)),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("developers_do_remove"),(function(){t?(cur.requestSaving=!0,ajax.post("editapp",{act:"delete_request",aid:cur.aid,hash:cur.requestHash,request_id:e},{onDone:AppsEdit.removeRequest.pbind(e,!1),onFail:AppsEdit.showRequestMsg.pbind(_,!0),hideProgress:function(){cur.requestSaving=!1}})):AppsEdit.removeRequest(e),i.hide()}),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_cancel"));else AppsEdit.removeRequest(e)},updateList:function(e,t){if(27==e.keyCode)return this.resetList(t);clearTimeout(cur.searchTimeout),setTimeout(function(){var e=trim(t.value);this.searchList(e)}.bind(this),10)},cleanStr:function(e){return e.replace(/([<>&#]*)/g,"")},resetList:function(e){return val(e,""),AppsEdit.searchList(!1)},searchList:function(e){e?(e=e.toLowerCase(),cur.disableSort=!0,addClass("apps_edit_funcs","apps_edit_no_sortable")):(delete cur.disableSort,removeClass("apps_edit_funcs","apps_edit_no_sortable")),toggle("apps_edit_reset_search",!!e);var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_funcs_not_found"),_=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("developers_no_funcs_found"),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_funcs"),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("apps_edit_sortable_row",a),s=0;for(var o in i)if(i.hasOwnProperty(o)){var r=i[o];if(e){var n=val(geByClass1("apps_edit_cont_name",r));(n=n.toLowerCase()).indexOf(e)>-1?(show(r),s++):hide(r)}else show(r),s++}if(e&&!s){var c=_.split("{query}").join("<b>"+this.cleanStr(e)+"</b>");t.innerHTML=c,show(t)}else hide(t)},uInit:function(e){AppsEdit.uInitScroll(),extend(cur,{opts:e,searchInp:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_search_inp"),index:{},cache:{},lang:extend(cur.lang||{},e.lang)});for(var t=[],_=["Top","Bottom","Left","Right"],a=0;a<4;++a)t.push("padding"+_[a]);var i=extend({margin:0},getStyle(cur.searchInp,t));Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.isFunction)(window.placeholderSetup)&&window.placeholderSetup(cur.searchInp,{back:!0,pad:i,phColor:"#929eb0"}),elfocus(cur.searchInp),cur.destroy.push((function(e){e==cur&&AppsEdit.uDeinitScroll()})),AppsEdit.uIndex(cur.opts.data)},uInitScroll:function(){AppsEdit.scrollnode=browser.msie6?pageNode:window,AppsEdit.uDeinitScroll(),addEvent(AppsEdit.scrollnode,"scroll",AppsEdit.uScroll),addEvent(window,"resize",AppsEdit.uScroll)},uDeinitScroll:function(){removeEvent(AppsEdit.scrollnode,"scroll",AppsEdit.uScroll),removeEvent(window,"resize",AppsEdit.uScroll)},uScroll:function(){if(!browser.mobile){var e=document.documentElement,t=window.innerHeight||e.clientHeight||bodyNode.clientHeight,_=scrollGetY(),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_users_more");isVisible(a)&&_+t>a.offsetTop&&a.onclick()}},uIndex:function(e,t){cur.opts.data=e,cur.cache={all:[]};for(var _=0,a=e.length;_<a;++_)cur.cache.all.push(_);cur.index=new vkIndexer(cur.cache.all,(function(e){return cur.opts.data[e][2]}),t?function(){}:AppsEdit.uSearchUpdate)},uResetSearch:function(){val(cur.searchInp,""),elfocus(cur.searchInp),AppsEdit.uSearchUpdate()},uSearch:function(){var e=trim(val(cur.searchInp));if(e.match(/^(https?:\/\/)?([a-z0-9]+\.)*(vkontakte\.ru|vk\.com)\/.+/))return AppsEdit.uEditAdmin(AppsEdit.uGetAddr(e))},uGetAddr:function(e){var t=e.match(/^(https?:\/\/)?([a-z0-9]+\.)*(vkontakte\.ru|vk\.com)\/(.+)$/),_=t[4].substr(t[4].indexOf("#")+1).replace(/^[\/\!]*/,"");return(t=_.match(/^profile\.php\?id=(\d+)/))?_=intval(t[1]):(-1!==_.indexOf("?")&&(_=_.substr(0,_.indexOf("?"))),(t=_.match(/^id(\d+)/))&&(_=intval(t[1]))),_},uSearchUpdate:function(){if("apps_edit_search_inp"==(cur.searchInp||{}).id){var e=trim(val(cur.searchInp));toggle("apps_edit_reset_search",!!e),AppsEdit.uShowMore(!0)}},uAddUpdate:function uAddUpdate(el){var q=trim(val(el));if(!q.match(/^(https?:\/\/)?([a-z0-9]+\.)*(vkontakte\.ru|vk\.com)\/.+/)||q===cur.lastUserQ)return!1;cur.lastUserQ=q;var addr=AppsEdit.uGetAddr(q);clearTimeout(cur.addAdminTO),cur.addAdminTO=setTimeout((function(){ajax.post("/al_apps_edit.php",{act:"edit_admin_box",id:cur.opts.aid,addr},{showProgress:function(){el&&addClass(domPN(el),"loading")},hideProgress:function(){el&&removeClass(domPN(el),"loading")},onFail:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_user_info");return!!t&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_add_user_error").innerHTML=e,show("apps_edit_add_user_error"),hide(t),curBox().setOptions({hideButtons:!0}),!0)},onDone:function onDone(title,html,js){var content=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_user_info");if(!content)return!1;hide("apps_edit_add_user_error"),content.innerHTML=html,show(content),curBox(),js&&eval(js)}})}),500)},uUpdateSummary:function(){!trim(val(cur.searchInp))&&isVisible("apps_edit_summary")&&(cur.opts.all_count>0?val("apps_edit_summary",cur.opts.all_count):hide("apps_edit_summary"))},uShowMore:function(e){var t=cur.opts.data,_=trim(val(cur.searchInp)),a=!1;if(t){var i=cur.cache.all;if(e){if(AppsEdit.uUpdateSummary(),cur.qShown===_)return;cur.qShown=_}if(_)if(_.match(/^(https?:\/\/)?([a-z0-9]+\.)*(vkontakte\.ru|vk\.com)\/.+/)){var s=AppsEdit.uGetAddr(_);i=[];for(var o=0,r=t.length;o<r;++o)t[o][0]!=s&&t[o][1]!="/"+s||i.push(o)}else{if(void 0===(i=cur.cache["_"+_])){var n=cur.index.search(_),c={};i=[];for(var d=0,p=n.length;d<p;++d)c[n[d]]||(c[n[d]]=!0,i.push(n[d]));i.sort((function(e,t){return e-t})),cur.cache["_"+_]=i}a=AppsEdit.uGetHighlight(_)}var l=i.length,u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_users_rows"),h=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_users_more");if(!l)return hide(h,"apps_edit_summary"),void val(u,AppsEdit.uGenEmpty(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_no_admin_found")));for(var b=e?0:u.childNodes.length,E=Math.min(l,b+20),m=[],g=b;g<E;++g){var v=t[i[g]],O=(v||{})[2];v&&(a&&(O=O.replace(a.re,a.val)),m.push(AppsEdit.uGenRow(v,O)))}e?(val(u,m.join("")),show("apps_edit_summary"),_?val("apps_edit_summary",l):AppsEdit.uUpdateSummary()):u.innerHTML+=m.join(""),toggle(h,E<l)}},uGetHighlight:function(e){var t=cur.index,_=t.delimiter,a=t.trimmer;return e+=" "+(Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.parseLatin)(e)||""),e=(e=escapeRE(e).replace(/&/g,"&amp;")).replace(a,"").replace(_,"|"),{re:new RegExp("("+e+")","gi"),val:'<span class="apps_edit_user_highlight">$1</span>'}},uGenEmpty:function(e){return'<div class="apps_edit_users_none">'+e+"</div>"},uGenRow:function(e,t){var _=e[0],a=e[1],i=e[3],s=e[5],o=cur.opts.levels[s]||"",r="",n=t||e[2],c=cur.qShown;if(!t&&c&&!c.match(/^(https?:\/\/)?([a-z0-9]+\.)*(vkontakte\.ru|vk\.com)\/.+/)){var d=AppsEdit.uGetHighlight(c);n=n.replace(d.re,d.val)}return cur.opts.main_admin&&cur.mainAdminChanging?4==s||5==s?r+="":3!=s?r+='<a class="apps_edit_user_action" onclick="AppsEdit.uChangeMainAdmin('+_+')">'+Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_main_admin_promote")+"</a>":r='<a class="apps_edit_user_action" onclick="AppsEdit.uMainAdmin(true)">'+Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_main_admin_change_cancel")+"</a>":0==s?r='<a class="apps_edit_user_action" onclick="AppsEdit.uEditAdmin('+_+')">'+Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_add_admin")+"</a>":3!=s?(r+='<a class="apps_edit_user_action" onclick="AppsEdit.uEditAdmin('+_+')">'+Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("Edit")+"</a>",r+=' | <a class="apps_edit_user_action" onclick="AppsEdit.uRemoveAdmin('+_+')">'+Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_edit_admin_demote")+"</a>"):cur.opts.main_admin&&cur.opts.all_count>1&&(r='<a class="apps_edit_user_action" onclick="AppsEdit.uMainAdmin()">'+Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_main_admin_change")+"</a>"),rs(cur.opts.template,{oid:_,name:n,photo:i,href:a,level:o,actions:r})},uShowMessage:function(e){return showDoneBox(e),!0},uEditAdmin:function(e){showBox("al_apps_edit.php",{act:"edit_admin_box",id:cur.opts.aid,addr:e},{onFail:AppsEdit.uShowMessage,params:{width:490}})},uAddAdmin:function(){cur.lastUserQ="",showBox("al_apps_edit.php",{act:"add_admin_box",id:cur.opts.aid},{onFail:AppsEdit.uShowMessage,params:{hideButtons:!0,width:490}})},uRemoveAdmin:function(e){var t=curBox();return t&&t.hide(),showBox("al_apps_edit.php",{act:"edit_admin_box",id:cur.opts.aid,addr:e,remove:1},{onFail:AppsEdit.uShowMessage,params:{width:490}}),!1},uSelAdminLevel:function(e,t,_){radiobtn(e,t,_);var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_admin_partial_level_desc").innerHTML.replace(/^\s+|[\s:]+$/g,"");t?(hide("apps_edit_admin_rights"),val("apps_admin_partial_level_desc",a)):(show("apps_edit_admin_rights"),val("apps_admin_partial_level_desc",a+":"))},uSaveAdmin:function(e,t){var _={act:"save_admin",id:cur.opts.aid,mid:e,hash:t,level:radioval("admins_level"),rights:[]};each(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("checkbox",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_admin_rights")),(function(e,t){isChecked(t)&&_.rights.push(t.getAttribute("id").replace(/^apps_admin_right_/,""))})),_.rights.length&&ajax.post("al_apps_edit.php",_,{onDone:function(t,_){if(curBox().hide(),t&&AppsEdit.uShowMessage(t),_){var a=cur.opts.data,i=!1;if(isArray(a))for(var s=0;s<a.length;++s)if(a[s][0]==e){i=!0,0==a[s][5]&&++cur.opts.all_count,cur.opts.data[s]=_;break}i?(delete cur.qShown,AppsEdit.uSearchUpdate()):(cur.opts.data.unshift(_),++cur.opts.all_count,val(cur.searchInp,""),delete cur.qShown,AppsEdit.uIndex(cur.opts.data)),AppsEdit.uUpdateSummary()}},showProgress:curBox().showProgress,hideProgress:curBox().hideProgress})},uDoRemoveAdmin:function(e,t){var _={act:"delete_admin",id:cur.opts.aid,mid:e,hash:t};ajax.post("al_apps_edit.php",_,{onDone:function(t,_){if(curBox().hide(),t&&AppsEdit.uShowMessage(t),_){var a=cur.opts.data;if(isArray(a))for(var i=0;i<a.length;++i)if(a[i][0]==e){cur.opts.data[i]=_,--cur.opts.all_count,delete cur.qShown,AppsEdit.uSearchUpdate();break}}},showProgress:curBox().showProgress,hideProgress:curBox().hideProgress})},uMainAdmin:function(e){if(e){if(!cur.mainAdminChanging)return;cur.mainAdminChanging=!1}else{if(cur.mainAdminChanging)return;cur.mainAdminChanging=!0}delete cur.qShown,AppsEdit.uSearchUpdate()},uChangeMainAdmin:function(e){if(cur.mainAdminChanging)return showBox("al_apps_edit.php",{act:"change_main_admin_box",id:cur.opts.aid,mid:e},{cache:1,onFail:function(e){return AppsEdit.uShowMessage(e),!0}}),!1},uDoChangeMainAdmin:function(e,t){var _={act:"change_main_admin",id:cur.opts.aid,mid:e,hash:t};ajax.post("al_apps_edit.php",_,{onDone:function(t,_){curBox().hide(),t&&AppsEdit.uShowMessage(t),cur.mainAdminChanging=!1,cur.opts.main_admin=_;var a=cur.opts.data;if(isArray(a)){for(var i=0;i=a.length;++i)a[i][0]==e?cur.opts.data[i][5]=3:3==cur.opts.data[i][5]&&(cur.opts.data[i][5]=2);delete cur.qShown,AppsEdit.uSearchUpdate()}},onFail:function(e){return curBox().hide(),AppsEdit.uShowMessage(e),!0},showProgress:curBox().showProgress,hideProgress:curBox().hideProgress})},initFunctionsClone:function(e){e&&(this.funcsCloneChoser=new Dropdown(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_clone_funcs_app_choser"),e,{width:230,big:1,multiselect:!1,noResult:""}))},cloneStoredFuncs:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_clone_button"),_=this,a=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_clone_stored_funcs_confirm_title"),dark:1,bodyStyle:"padding: 20px; line-height: 160%;"},Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_clone_stored_funcs_confirm_text"),Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_clone_stored_funcs_confirm_button"),(function(){a.hide(),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.lockButton)(t),ajax.post("al_apps_edit.php",{act:"clone_funcs",from_aid:cur.aid,to_aid:_.funcsCloneChoser.val(),hash:e},{onDone:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_11__.unlockButton)(t)}})}),"Close",(function(){a.hide()}))},loadStatApiData:function loadStatApiData(method,statInterval){if(cur.api_stat_interval==statInterval&&cur.api_stat_filter_method==method)return!1;ajax.post("editapp",{act:"stats_api_data",id:cur.aid,method,stat_interval:statInterval,hash:cur.statsApiHash},{cache:1,onDone:function onDone(content,script){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_stats_api").innerHTML=content,cur.api_stat_interval=statInterval,cur.api_stat_filter_method=method,script&&eval(script),"2days"!=statInterval||""!=method){var newLocVars={};""!=method&&(newLocVars.method=method),"2days"!=statInterval&&(newLocVars.stat_interval=statInterval),nav.setLoc(extend(nav.objLoc,{method,stat_interval:statInterval}))}},onFail:AppsEdit.showError,showProgress:function(){cur.api_stat_interval=statInterval,removeClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("api_interval_selector_2days"),"selected"),removeClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("api_interval_selector_week"),"selected"),removeClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("api_interval_selector_month"),"selected"),addClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("api_interval_selector_"+cur.api_stat_interval),"selected"),show(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_api_prg"))},hideProgress:function(){hide(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_api_prg"))}})},changeStatBlockPeriod:function(e,t,_){cur.statsMainBlockCurrentPeriodType=cur.statsMainBlockCurrentPeriodType||"day",e.classList.contains("selected")||(document.querySelectorAll(".app_stats_main_block_tab").forEach(e=>{e.classList.toggle("selected")}),document.querySelectorAll(".appMainStats__counter").forEach(e=>{e.classList.toggle("appMainStats__counter--active")}),cur.statsMainBlockCurrentPeriodType!==_&&(toggle(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_stat_main_block1_day")),toggle(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_stat_main_block2_day")),toggle(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_stat_main_block3_day")),toggle(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_stat_main_block1_subtitle_day")),toggle(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_stat_main_block1_month")),toggle(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_stat_main_block2_month")),toggle(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_stat_main_block3_month")),toggle(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("app_stat_main_block1_subtitle_month")),cur.statsMainBlockCurrentPeriodType=_))},chooseVideo:function(e,t){var _={promo:"a_save_promo_video",banner:"a_save_banner_video"},a={promo:"apps_edit_promo_video_thumb",banner:"apps_edit_banner_video_thumb"},i=showBox("al_video.php",{act:"a_choose_video_box",from:"article",app_id:cur.aid},{stat:["page.css","page.js"],cache:1});cur.chooseMedia=function(s,o,r){var n=_[t];return ajax.post("al_apps.php",{act:n,aid:cur.aid,hash:e,video_id:o},{onDone:function(e){if(e)Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_error"),dark:1},e);else{i.hide();var _=r.editable&&r.editable.sizes&&r.editable.sizes.l?r.editable.sizes.l[0]:r.thumb,s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)(a[t]);domData(s,"video-id",o),setStyle(s,"background-image","url('"+_+"')"),show(s)}},onFail:function(e){return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_error"),dark:1},e),!0}}),!1}},showVideo:function(e){function t(t,_){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var _=domData(e,"video-id");if(_)return showVideo(_,"",{autoplay:1,queue:1},t)})),removeSelectedVideo:function(e,t,_){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)({promo:"apps_edit_promo_video_thumb",banner:"apps_edit_banner_video_thumb"}[_]),i={promo:"a_save_promo_video",banner:"a_save_banner_video"}[_];return hide(a),ajax.post("al_apps.php",{act:i,aid:cur.aid,hash:e},{onFail:function(e){return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("global_error"),dark:1},e),show(a),!0}}),cancelEvent(t),!1},hideWarning:function(e,t,_){ajax.post("editapp",{act:"a_hide_warning",app_id:cur.aid,name:t,hash:_},{onDone:function(){hide(geByClass1("app_edit_warning","app_edit_warning_wrap"))}})},getPanoramicBannerSlidesCnt:function(e){return(e=e||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_featured_slides"))?domChildren(e).length:0},removePanoramicBannerThumb:function(e,t,_,a,i){cancelEvent(t);var s,o,r={act:"a_remove_panoramic_banner",aid:_,seq:a,hash:i},n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_panoramic_banner_error"),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.domCA)(e,".apps_featured_thumb"),d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_featured_slides"),p=this.getPanoramicBannerSlidesCnt(d)-1,l=window.cur&&cur.panoramicBannerAppsSlider,u=l&&l.indexCurrent||0;return s=(s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.domChildIndex)(c,d)===p)||u===p,window.tooltips&&tooltips.hideAll(),ajax.post("editapp",r,{onFail:function(e){if(n&&e)return n.textContent=e,show(n),!0}}),re(c),(o=this.getPanoramicBannerSlidesCnt(d))?(l&&l.update(),s&&l&&l.prev()):this.hidePanoramicBannerWrapper(),this.canAddNewPanoramicBannerPhoto(d)&&this.enablePanoramicBannerUploadBtn(),o<=1&&this.hideSliderArrows(),!1},addNewPanoramicBannerThumb:function(e){var t,_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_featured_slides"),a=window.cur&&cur.panoramicBannerAppsSlider;_&&(t=domChildren(_).length,_.insertAdjacentHTML("beforeEnd",e),t?(a&&a.update(),a&&a.last()):(a||(this.initPanoramicBannerAppsSlider(),a=window.cur&&cur.panoramicBannerAppsSlider),this.showPanoramicBannerWrapper(),a&&a.prev()),this.getPanoramicBannerSlidesCnt(_)>1&&this.showSliderArrows()),this.canAddNewPanoramicBannerPhoto(_)||this.disablePanoramicBannerUploadBtn()},canAddNewPanoramicBannerPhoto:function(e){return this.getPanoramicBannerSlidesCnt(e)<this.PANORAMIC_SLIDER_MAX_PHOTOS},enablePanoramicBannerUploadBtn:function(){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_upload_panoramic_banner");e&&removeClass(e,"apps_edit_upload_panoramic_banner_disable")},disablePanoramicBannerUploadBtn:function(){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_upload_panoramic_banner");e&&addClass(e,"apps_edit_upload_panoramic_banner_disable")},showPanoramicBannerWrapper:function(){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_panoramic_wrap");removeClass(e,"apps_edit_full_wrap_hidden")},showSliderArrows:function(){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_featured_slider"),t=geByClass1("apps_featured_prev",e),_=geByClass1("apps_featured_next",e);removeClass(t,"apps_featured_prev_hidden"),removeClass(_,"apps_featured_next_hidden")},hideSliderArrows:function(){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_featured_slider"),t=geByClass1("apps_featured_prev",e),_=geByClass1("apps_featured_next",e);addClass(t,"apps_featured_prev_hidden"),addClass(_,"apps_featured_next_hidden")},hidePanoramicBannerWrapper:function(){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_panoramic_wrap");addClass(e,"apps_edit_full_wrap_hidden")},initPanoramicBannerAppsSlider:function(){if(window.Apps&&window.cur&&this.getPanoramicBannerSlidesCnt()){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_featured_slides");cur.panoramicBannerAppsSlider=window.Apps.makeAppSlider({inner:"apps_featured_slides",outer:"apps_featured_slider",next:"apps_featured_next",prev:"apps_featured_prev",infinite:!1}),cur.panoramicBannerAppsSlider.prev(),this.getPanoramicBannerSlidesCnt(e)<=1&&this.hideSliderArrows()}},initPanoramicBanner:function(){this.initPanoramicBannerAppsSlider();var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("apps_edit_upload_panoramic_banner");addEvent(e,"click",(function(e){if(hasClass(this,"apps_edit_upload_panoramic_banner_disable"))return showTitle(this,null,[0,7,0,0],{appendEl:document.body}),void cancelEvent(e)}))},catalogBannerRadio:function(e){window.radioBtns.catalog_banner_title_color={els:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("radiobtn",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("radiobtn_catalog_banner_title_color")),val:e||"ffffff"}},onChangeBannerDescription:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("catalog_banner_mock__description");(e.value||""===e.value)&&(e.value.length>48&&(e.value=e.value.substring(0,48)),t.innerHTML=this.escapeHTML(e.value))},hideTopNotice:function(e,t,_){var a="apps_"+e,i={act:"a_hide_top_notice",notice:e,app_id:t,hash:_};return ajax.post("al_apps_edit.php",i),slideUp(document.getElementById(a),150,re.pbind(a)),!1},escapeHTML:function(e){for(var t="",_=0;_<e.length;_++)"<"===e[_]?t+="&lt;":">"===e[_]?t+="&gt;":"'"===e[_]?t+="&#39;":'"'===e[_]?t+="&quot;":t+=e[_];return t},renderColorPalette:function(e,t,_){var a=geByClass1("AppsEditColorPalette__Container");if(a&&isArray(t)&&t.length){var i="",s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("widget_color1").value;t.forEach(e=>{i+=`<li class="AppsEditColorPalette__Item${s==s?" AppsEditColorPalette__Item--active":""}" style="background-color: #${e}">\n  <input type="text" value="${e}" onclick="AppsEdit.changeBannerColor(this);">\n</li>`,a.innerHTML=i})}isArray(_)?_.forEach((function(t){t&&(t.src=e,addClass(_.parentNode,"apps_edit_img_loaded"))})):(_.src=e,addClass(_.parentNode,"apps_edit_img_loaded"))},changeBannerColor:function(e){/^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(e.value)&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("catalog_banner_mock").style.backgroundColor="#"+e.value,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("widget_color1").value=e.value,AppsEdit.onChangeBannerColor(e),each(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("AppsEditColorPalette__Item"),(function(e,t){t.classList.remove("AppsEditColorPalette__Item--active")})),e.parentNode.classList.add("AppsEditColorPalette__Item--active"))},onChangeBannerColor:function(e){/^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(e.value)?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("catalog_banner_mock").style.backgroundColor="#"+e.value,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("dev_colorbox1").style.backgroundColor="#"+e.value,e.classList.remove("error")):/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(e.value)?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("catalog_banner_mock").style.backgroundColor=e.value,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("dev_colorbox1").style.backgroundColor=e.value,e.value=e.value.substr(1),e.classList.remove("error")):e.classList.add("error")},onChangeBannerFontColor:function(e){if(e){radiobtn(e,e.dataset.val,"catalog_banner_title_color");var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("catalog_banner_mock__title"),_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("catalog_banner_mock__description"),a=e.dataset.val;~["000","000000","fff","ffffff","FFF","FFFFFF"].indexOf(a)||(a="000000"),t.style.color="#"+e.dataset.val,_.style.color="#"+e.dataset.val}},slideShow:function(e){isVisible(e)||slideDown(e,150)},slideHide:function(e){isVisible(e)&&slideUp(e,150)},vkAppModalCheckbox:function(){var e=curBox().btns.ok[0];e.classList.toggle("flat_button_disabled"),e.disabled=!e.disabled},showMainStatsHint(e,t){Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:t,showdt:1,black:1,forcetodown:1,shift:[14,0,10]})},initWideScreenOptions:e=>{var t=document.querySelector("#widescreen_type");if(t&&(window.radioBtns||(window.radioBtns={}),t)){window.radioBtns.widescreen_type={els:t.querySelectorAll(".radiobtn"),val:e};var _=document.querySelector("#apps_edit_widescreen_type"+e);_&&_.classList.add("on")}},initDirectGamesOptions:(e,t)=>{var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("mobile_controls_type"),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("mobile_view_support_type");(_||a)&&(window.radioBtns||(window.radioBtns={}),_&&(window.radioBtns.mobile_controls_type={els:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("radiobtn",_),val:e},addClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("mobile_controls_type"+e),"on")),a&&(window.radioBtns.mobile_view_support_type={els:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.geByClass)("radiobtn",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("mobile_view_support_type")),val:t},addClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_10__.ge)("mobile_view_support_type"+t),"on")))},showDgSettingsTooltip(e,t){window.tooltips&&window.tooltips.hideAll();var _=getSize(e),a=e.dataset.ttImg,i=e.dataset.title;Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:`<div class="apps_editDirectGamesTTContent">\n               <img src="${a}" class="apps_editDirectGamesTTContent__img">\n               <span class="apps_editDirectGamesTTText">${i}</span>\n             </div>`,slideX:15,dir:"left",hasover:1,className:"apps_editDirectGamesTT",shift:[-_[0]-14,t||89]})},showAppleIdTooltip(e){Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_15__.getLang)("apps_m_iframe_dev_team_id_tt"),dir:"auto",shift:[22,0],slide:15,hasover:!0,className:"settings_tt"})},initUploadDistributive(e,t){var _=new _apps_UploaderDistributive__WEBPACK_IMPORTED_MODULE_19__.default(t,curBox());Upload.init("AppsEditUploadDistributive",e,t.vars,_.getOptions())},MarusiaSkill:new _apps_edit_MarusiaSkill_MarusiaSkill__WEBPACK_IMPORTED_MODULE_21__.MarusiaSkill,GraphsHelper:new _apps_edit_Graphs_GraphsHelper__WEBPACK_IMPORTED_MODULE_22__.GraphsHelper,ModerationRequest:new _apps_edit_ModerationRequest_ModerationRequest__WEBPACK_IMPORTED_MODULE_23__.ModerationRequest,_eof:1};window.AppsEdit=AppsEdit,window.Sales=_apps_edit_sales_Sales__WEBPACK_IMPORTED_MODULE_18__.Sales;try{stManager.done("apps_edit.js")}catch(e){}},z1JT:function(e,t,_){"use strict";_.r(t),_.d(t,"STATE_NEW",(function(){return a})),_.d(t,"STATE_ACTIVE",(function(){return i})),_.d(t,"STATE_APPROVED",(function(){return s})),_.d(t,"STATE_DISABLED",(function(){return o})),_.d(t,"STATE_PENDING",(function(){return r})),_.d(t,"STATE_DECLINED",(function(){return n})),_.d(t,"STATE_DELETED",(function(){return c})),_.d(t,"DEFAULT_PRODUCT_COLOR",(function(){return d})),_.d(t,"DEFAULT_PRODUCT_ICON_SRC",(function(){return p}));var a=0,i=1,s=2,o=3,r=4,n=5,c=6,d="A8B8C8",p="/images/apps/sales/product.png"}});